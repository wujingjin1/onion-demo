import{c as Ze,t as _e,n as je,o as Be,d as xe,r as te,B as Ot,u as _n,j as me,w as ye,a8 as Sn,a9 as Tn,al as xi,v as pt,am as Ii,an as Ri,a3 as Di,a4 as Sr,x as Pn,b as F,ao as Bt,A as an,y as vt,D as qt,Y as Me,f as rt,h as $n,a as En,ae as Cr,g as Et,p as ct,k as ht,a1 as Ai,ap as gr,X as On,a2 as kn,m as Xe,ai as Pe,aq as Mi,Q as ut,Z as Pt,ar as ji,z as xn,as as Fi,e as In,a0 as Ui,at as Rn,au as Dn,av as Li,l as An,aj as _r,aw as Wi,ax as zi,E as Ae,F as Ne,N as j,P as Vi,M as Ni,$ as Bi,R as yr,J as Hi,H as M,ay as He,O as ze,G as it,ak as Ye,T as Yi,S as qi,U as Tt,V as Xi,W as Gi,_ as Ji}from"./index-B-Wldk82.js";import{a as Mn,u as kt,L as jn,P as Zi,m as Ki,c as Qi,g as Tr,p as Pr,b as es,s as tt,B as br}from"./use-dictionary-BqbBp34p.js";import{c as ts,s as rs}from"./Checker-CIUskSoX.js";const[Fn,Ht]=Ze("swipe"),ns={loop:_e,width:je,height:je,vertical:Boolean,autoplay:Be(0),duration:Be(500),touchable:_e,lazyRender:Boolean,initialSwipe:Be(0),indicatorColor:String,showIndicators:_e,stopPropagation:_e},Un=Symbol(Fn);var as=xe({name:Fn,props:ns,emits:["change","dragStart","dragEnd"],setup(e,{emit:o,slots:a}){const s=te(),u=te(),l=Ot({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let g=!1;const _=Mn(),{children:h,linkChildren:y}=_n(Un),v=me(()=>h.length),d=me(()=>l[e.vertical?"height":"width"]),E=me(()=>e.vertical?_.deltaY.value:_.deltaX.value),k=me(()=>l.rect?(e.vertical?l.rect.height:l.rect.width)-d.value*v.value:0),A=me(()=>d.value?Math.ceil(Math.abs(k.value)/d.value):v.value),q=me(()=>v.value*d.value),P=me(()=>(l.active+v.value)%v.value),Y=me(()=>{const I=e.vertical?"vertical":"horizontal";return _.direction.value===I}),W=me(()=>{const I={transitionDuration:`${l.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${+l.offset.toFixed(2)}px)`};if(d.value){const X=e.vertical?"height":"width",Q=e.vertical?"width":"height";I[X]=`${q.value}px`,I[Q]=e[Q]?`${e[Q]}px`:""}return I}),w=I=>{const{active:X}=l;return I?e.loop?Me(X+I,-1,v.value):Me(X+I,0,A.value):X},O=(I,X=0)=>{let Q=I*d.value;e.loop||(Q=Math.min(Q,-k.value));let Ce=X-Q;return e.loop||(Ce=Me(Ce,k.value,0)),Ce},T=({pace:I=0,offset:X=0,emitChange:Q})=>{if(v.value<=1)return;const{active:Ce}=l,oe=w(I),Ie=O(oe,X);if(e.loop){if(h[0]&&Ie!==k.value){const Ke=Ie<k.value;h[0].setOffset(Ke?q.value:0)}if(h[v.value-1]&&Ie!==0){const Ke=Ie>0;h[v.value-1].setOffset(Ke?-q.value:0)}}l.active=oe,l.offset=Ie,Q&&oe!==Ce&&o("change",P.value)},re=()=>{l.swiping=!0,l.active<=-1?T({pace:v.value}):l.active>=v.value&&T({pace:-v.value})},fe=()=>{re(),_.reset(),Bt(()=>{l.swiping=!1,T({pace:-1,emitChange:!0})})},x=()=>{re(),_.reset(),Bt(()=>{l.swiping=!1,T({pace:1,emitChange:!0})})};let N;const Z=()=>clearTimeout(N),G=()=>{Z(),+e.autoplay>0&&v.value>1&&(N=setTimeout(()=>{x(),G()},+e.autoplay))},V=(I=+e.initialSwipe)=>{if(!s.value)return;const X=()=>{var Q,Ce;if(!an(s)){const oe={width:s.value.offsetWidth,height:s.value.offsetHeight};l.rect=oe,l.width=+((Q=e.width)!=null?Q:oe.width),l.height=+((Ce=e.height)!=null?Ce:oe.height)}v.value&&(I=Math.min(v.value-1,I),I===-1&&(I=v.value-1)),l.active=I,l.swiping=!0,l.offset=O(I),h.forEach(oe=>{oe.setOffset(0)}),G()};an(s)?vt().then(X):X()},be=()=>V(l.active);let Ee;const Oe=I=>{!e.touchable||I.touches.length>1||(_.start(I),g=!1,Ee=Date.now(),Z(),re())},D=I=>{e.touchable&&l.swiping&&(_.move(I),Y.value&&(!e.loop&&(l.active===0&&E.value>0||l.active===v.value-1&&E.value<0)||(qt(I,e.stopPropagation),T({offset:E.value}),g||(o("dragStart",{index:P.value}),g=!0))))},z=()=>{if(!e.touchable||!l.swiping)return;const I=Date.now()-Ee,X=E.value/I;if((Math.abs(X)>.25||Math.abs(E.value)>d.value/2)&&Y.value){const Ce=e.vertical?_.offsetY.value:_.offsetX.value;let oe=0;e.loop?oe=Ce>0?E.value>0?-1:1:0:oe=-Math[E.value>0?"ceil":"floor"](E.value/d.value),T({pace:oe,emitChange:!0})}else E.value&&T({pace:0});g=!1,l.swiping=!1,o("dragEnd",{index:P.value}),G()},B=(I,X={})=>{re(),_.reset(),Bt(()=>{let Q;e.loop&&I===v.value?Q=l.active===0?0:I:Q=I%v.value,X.immediate?Bt(()=>{l.swiping=!1}):l.swiping=!1,T({pace:Q-l.active,emitChange:!0})})},ee=(I,X)=>{const Q=X===P.value,Ce=Q?{backgroundColor:e.indicatorColor}:void 0;return F("i",{style:Ce,class:Ht("indicator",{active:Q})},null)},we=()=>{if(a.indicator)return a.indicator({active:P.value,total:v.value});if(e.showIndicators&&v.value>1)return F("div",{class:Ht("indicators",{vertical:e.vertical})},[Array(v.value).fill("").map(ee)])};return kt({prev:fe,next:x,state:l,resize:be,swipeTo:B}),y({size:d,props:e,count:v,activeIndicator:P}),ye(()=>e.initialSwipe,I=>V(+I)),ye(v,()=>V(l.active)),ye(()=>e.autoplay,G),ye([Sn,Tn,()=>e.width,()=>e.height],be),ye(xi(),I=>{I==="visible"?G():Z()}),pt(V),Ii(()=>V(l.active)),Ri(()=>V(l.active)),Di(Z),Sr(Z),Pn("touchmove",D,{target:u}),()=>{var I;return F("div",{ref:s,class:Ht()},[F("div",{ref:u,style:W.value,class:Ht("track",{vertical:e.vertical}),onTouchstartPassive:Oe,onTouchend:z,onTouchcancel:z},[(I=a.default)==null?void 0:I.call(a)]),we()])}}});const os=rt(as),[is,ss]=Ze("swipe-item");var ls=xe({name:is,setup(e,{slots:o}){let a;const s=Ot({offset:0,inited:!1,mounted:!1}),{parent:u,index:l}=$n(Un);if(!u)return;const g=me(()=>{const y={},{vertical:v}=u.props;return u.size.value&&(y[v?"height":"width"]=`${u.size.value}px`),s.offset&&(y.transform=`translate${v?"Y":"X"}(${s.offset}px)`),y}),_=me(()=>{const{loop:y,lazyRender:v}=u.props;if(!v||a)return!0;if(!s.mounted)return!1;const d=u.activeIndicator.value,E=u.count.value-1,k=d===0&&y?E:d-1,A=d===E&&y?0:d+1;return a=l.value===d||l.value===k||l.value===A,a}),h=y=>{s.offset=y};return pt(()=>{vt(()=>{s.mounted=!0})}),kt({setOffset:h}),()=>{var y;return F("div",{class:ss(),style:g.value},[_.value?(y=o.default)==null?void 0:y.call(o):null])}}});const cs=rt(ls),[Ln,us]=Ze("radio-group"),ds={shape:String,disabled:Boolean,iconSize:je,direction:String,modelValue:Cr,checkedColor:String},Wn=Symbol(Ln);var fs=xe({name:Ln,props:ds,emits:["change","update:modelValue"],setup(e,{emit:o,slots:a}){const{linkChildren:s}=_n(Wn),u=l=>o("update:modelValue",l);return ye(()=>e.modelValue,l=>o("change",l)),s({props:e,updateValue:u}),En(()=>e.modelValue),()=>{var l;return F("div",{class:us([e.direction]),role:"radiogroup"},[(l=a.default)==null?void 0:l.call(a)])}}});const vs=rt(fs),hs=Et({},ts,{shape:String}),[ms,ps]=Ze("radio");var gs=xe({name:ms,props:hs,emits:["update:modelValue"],setup(e,{emit:o,slots:a}){const{parent:s}=$n(Wn),u=()=>(s?s.props.modelValue:e.modelValue)===e.name,l=()=>{s?s.updateValue(e.name):o("update:modelValue",e.name)};return()=>F(rs,ht({bem:ps,role:"radio",parent:s,checked:u(),onToggle:l},e),ct(a,["default","icon"]))}});const on=rt(gs),[ys,st]=Ze("image"),bs={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:je,height:je,radius:je,lazyLoad:Boolean,iconSize:je,showError:_e,errorIcon:Xe("photo-fail"),iconPrefix:String,showLoading:_e,loadingIcon:Xe("photo"),crossorigin:String,referrerpolicy:String};var ws=xe({name:ys,props:bs,emits:["load","error"],setup(e,{emit:o,slots:a}){const s=te(!1),u=te(!0),l=te(),{$Lazyload:g}=Ai().proxy,_=me(()=>{const P={width:gr(e.width),height:gr(e.height)};return On(e.radius)&&(P.overflow="hidden",P.borderRadius=gr(e.radius)),P});ye(()=>e.src,()=>{s.value=!1,u.value=!0});const h=P=>{u.value&&(u.value=!1,o("load",P))},y=()=>{const P=new Event("load");Object.defineProperty(P,"target",{value:l.value,enumerable:!0}),h(P)},v=P=>{s.value=!0,u.value=!1,o("error",P)},d=(P,Y,W)=>W?W():F(ut,{name:P,size:e.iconSize,class:Y,classPrefix:e.iconPrefix},null),E=()=>{if(u.value&&e.showLoading)return F("div",{class:st("loading")},[d(e.loadingIcon,st("loading-icon"),a.loading)]);if(s.value&&e.showError)return F("div",{class:st("error")},[d(e.errorIcon,st("error-icon"),a.error)])},k=()=>{if(s.value||!e.src)return;const P={alt:e.alt,class:st("img"),style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?Pe(F("img",ht({ref:l},P),null),[[Mi("lazy"),e.src]]):F("img",ht({ref:l,src:e.src,onLoad:h,onError:v},P),null)},A=({el:P})=>{const Y=()=>{P===l.value&&u.value&&y()};l.value?Y():vt(Y)},q=({el:P})=>{P===l.value&&!s.value&&v()};return g&&kn&&(g.$on("loaded",A),g.$on("error",q),Sr(()=>{g.$off("loaded",A),g.$off("error",q)})),pt(()=>{vt(()=>{var P;(P=l.value)!=null&&P.complete&&!e.lazyLoad&&y()})}),()=>{var P;return F("div",{class:st({round:e.round,block:e.block}),style:_.value},[k(),E(),(P=a.default)==null?void 0:P.call(a)])}}});const zn=rt(ws),sn=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Cs=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),wr=Ze("image-preview")[1],ln=2.6,_s={src:String,show:Boolean,active:Number,minZoom:Pt(je),maxZoom:Pt(je),rootWidth:Pt(Number),rootHeight:Pt(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean,vertical:Boolean};var Ss=xe({props:_s,emits:["scale","close","longPress"],setup(e,{emit:o,slots:a}){const s=Ot({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),u=Mn(),l=te(),g=te(),_=te(!1),h=te(!1);let y=0;const v=me(()=>{const{scale:D,moveX:z,moveY:B,moving:ee,zooming:we,initializing:I}=s,X={transitionDuration:we||ee||I?"0s":".3s"};return(D!==1||h.value)&&(X.transform=`matrix(${D}, 0, 0, ${D}, ${z}, ${B})`),X}),d=me(()=>{if(s.imageRatio){const{rootWidth:D,rootHeight:z}=e,B=_.value?z/s.imageRatio:D;return Math.max(0,(s.scale*B-D)/2)}return 0}),E=me(()=>{if(s.imageRatio){const{rootWidth:D,rootHeight:z}=e,B=_.value?z:D*s.imageRatio;return Math.max(0,(s.scale*B-z)/2)}return 0}),k=(D,z)=>{var B;if(D=Me(D,+e.minZoom,+e.maxZoom+1),D!==s.scale){const ee=D/s.scale;if(s.scale=D,z){const we=xn((B=l.value)==null?void 0:B.$el),I={x:we.width*.5,y:we.height*.5},X=s.moveX-(z.x-we.left-I.x)*(ee-1),Q=s.moveY-(z.y-we.top-I.y)*(ee-1);s.moveX=Me(X,-d.value,d.value),s.moveY=Me(Q,-E.value,E.value)}else s.moveX=0,s.moveY=h.value?y:0;o("scale",{scale:D,index:e.active})}},A=()=>{k(1)},q=()=>{const D=s.scale>1?1:2;k(D,D===2||h.value?{x:u.startX.value,y:u.startY.value}:void 0)};let P,Y,W,w,O,T,re,fe,x=!1;const N=D=>{const{touches:z}=D;if(P=z.length,P===2&&e.disableZoom)return;const{offsetX:B}=u;u.start(D),Y=s.moveX,W=s.moveY,fe=Date.now(),x=!1,s.moving=P===1&&(s.scale!==1||h.value),s.zooming=P===2&&!B.value,s.zooming&&(w=s.scale,O=sn(z))},Z=D=>{const{touches:z}=D;if(u.move(D),s.moving){const{deltaX:B,deltaY:ee}=u,we=B.value+Y,I=ee.value+W;if((e.vertical?u.isVertical()&&Math.abs(I)>E.value:u.isHorizontal()&&Math.abs(we)>d.value)&&!x){s.moving=!1;return}x=!0,qt(D,!0),s.moveX=Me(we,-d.value,d.value),s.moveY=Me(I,-E.value,E.value)}if(s.zooming&&(qt(D,!0),z.length===2)){const B=sn(z),ee=w*B/O;T=Cs(z),k(ee,T)}},G=D=>{var z;const B=(z=g.value)==null?void 0:z.$el;if(!B)return;const ee=B.firstElementChild,we=D.target===B,I=ee==null?void 0:ee.contains(D.target);!e.closeOnClickImage&&I||!e.closeOnClickOverlay&&we||o("close")},V=D=>{if(P>1)return;const z=Date.now()-fe,B=250;u.isTap.value&&(z<B?e.doubleScale?re?(clearTimeout(re),re=null,q()):re=setTimeout(()=>{G(D),re=null},B):G(D):z>Fi&&o("longPress"))},be=D=>{let z=!1;if((s.moving||s.zooming)&&(z=!0,s.moving&&Y===s.moveX&&W===s.moveY&&(z=!1),!D.touches.length)){s.zooming&&(s.moveX=Me(s.moveX,-d.value,d.value),s.moveY=Me(s.moveY,-E.value,E.value),s.zooming=!1),s.moving=!1,Y=0,W=0,w=1,s.scale<1&&A();const B=+e.maxZoom;s.scale>B&&k(B,T)}qt(D,z),V(D),u.reset()},Ee=()=>{const{rootWidth:D,rootHeight:z}=e,B=z/D,{imageRatio:ee}=s;_.value=s.imageRatio>B&&ee<ln,h.value=s.imageRatio>B&&ee>=ln,h.value&&(y=(ee*D-z)/2,s.moveY=y,s.initializing=!0,ji(()=>{s.initializing=!1})),A()},Oe=D=>{const{naturalWidth:z,naturalHeight:B}=D.target;s.imageRatio=B/z,Ee()};return ye(()=>e.active,A),ye(()=>e.show,D=>{D||A()}),ye(()=>[e.rootWidth,e.rootHeight],Ee),Pn("touchmove",Z,{target:me(()=>{var D;return(D=g.value)==null?void 0:D.$el})}),kt({resetScale:A}),()=>{const D={loading:()=>F(jn,{type:"spinner"},null)};return F(cs,{ref:g,class:wr("swipe-item"),onTouchstartPassive:N,onTouchend:be,onTouchcancel:be},{default:()=>[a.image?F("div",{class:wr("image-wrap")},[a.image({src:e.src,onLoad:Oe,style:v.value})]):F(zn,{ref:l,src:e.src,fit:"contain",class:wr("image",{vertical:_.value}),style:v.value,onLoad:Oe},D)]})}}});const[Ts,lt]=Ze("image-preview"),Ps=["show","teleport","transition","overlayStyle","closeOnPopstate"],$s={show:Boolean,loop:_e,images:In(),minZoom:Be(1/3),maxZoom:Be(3),overlay:_e,vertical:Boolean,closeable:Boolean,showIndex:_e,className:Cr,closeIcon:Xe("clear"),transition:String,beforeClose:Function,doubleScale:_e,overlayClass:Cr,overlayStyle:Object,swipeDuration:Be(300),startPosition:Be(0),showIndicators:Boolean,closeOnPopstate:_e,closeOnClickImage:_e,closeOnClickOverlay:_e,closeIconPosition:Xe("top-right"),teleport:[String,Object]};var Vn=xe({name:Ts,props:$s,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:o,slots:a}){const s=te(),u=te(),l=Ot({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),g=()=>{if(s.value){const w=xn(s.value.$el);l.rootWidth=w.width,l.rootHeight=w.height,s.value.resize()}},_=w=>o("scale",w),h=w=>o("update:show",w),y=()=>{Rn(e.beforeClose,{args:[l.active],done:()=>h(!1)})},v=w=>{w!==l.active&&(l.active=w,o("change",w))},d=()=>{if(e.showIndex)return F("div",{class:lt("index")},[a.index?a.index({index:l.active}):`${l.active+1} / ${e.images.length}`])},E=()=>{if(a.cover)return F("div",{class:lt("cover")},[a.cover()])},k=()=>{l.disableZoom=!0},A=()=>{l.disableZoom=!1},q=()=>F(os,{ref:s,lazyRender:!0,loop:e.loop,class:lt("swipe"),vertical:e.vertical,duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:v,onDragEnd:A,onDragStart:k},{default:()=>[e.images.map((w,O)=>F(Ss,{ref:T=>{O===l.active&&(u.value=T)},src:w,show:e.show,active:l.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:l.rootWidth,rootHeight:l.rootHeight,disableZoom:l.disableZoom,doubleScale:e.doubleScale,closeOnClickImage:e.closeOnClickImage,closeOnClickOverlay:e.closeOnClickOverlay,vertical:e.vertical,onScale:_,onClose:y,onLongPress:()=>o("longPress",{index:O})},{image:a.image}))]}),P=()=>{if(e.closeable)return F(ut,{role:"button",name:e.closeIcon,class:[lt("close-icon",e.closeIconPosition),Ui],onClick:y},null)},Y=()=>o("closed"),W=(w,O)=>{var T;return(T=s.value)==null?void 0:T.swipeTo(w,O)};return kt({resetScale:()=>{var w;(w=u.value)==null||w.resetScale()},swipeTo:W}),pt(g),ye([Sn,Tn],g),ye(()=>e.startPosition,w=>v(+w)),ye(()=>e.show,w=>{const{images:O,startPosition:T}=e;w?(v(+T),vt(()=>{g(),W(+T,{immediate:!0})})):o("close",{index:l.active,url:O[l.active]})}),()=>F(Zi,ht({class:[lt(),e.className],overlayClass:[lt("overlay"),e.overlayClass],onClosed:Y,"onUpdate:show":h},ct(e,Ps)),{default:()=>[P(),q(),d(),E()]})}});let Xt;const Es={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function Os(){({instance:Xt}=Ki({setup(){const{state:e,toggle:o}=Qi(),a=()=>{e.images=[]};return()=>F(Vn,ht(e,{onClosed:a,"onUpdate:show":o}),null)}}))}const ks=(e,o=0)=>{if(kn)return Xt||Os(),e=Array.isArray(e)?{images:e,startPosition:o}:e,Xt.open(Et({},Es,e)),Xt};rt(Vn);const[xs,he,Is]=Ze("uploader");function cn(e,o){return new Promise(a=>{if(o==="file"){a();return}const s=new FileReader;s.onload=u=>{a(u.target.result)},o==="dataUrl"?s.readAsDataURL(e):o==="text"&&s.readAsText(e)})}function Nn(e,o){return Dn(e).some(a=>a.file?Li(o)?o(a.file):a.file.size>+o:!1)}function Rs(e,o){const a=[],s=[];return e.forEach(u=>{Nn(u,o)?s.push(u):a.push(u)}),{valid:a,invalid:s}}const Ds=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,As=e=>Ds.test(e);function Bn(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?As(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Ms=xe({props:{name:je,item:Pt(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:o,slots:a}){const s=()=>{const{status:v,message:d}=e.item;if(v==="uploading"||v==="failed"){const E=v==="failed"?F(ut,{name:"close",class:he("mask-icon")},null):F(jn,{class:he("loading")},null),k=On(d)&&d!=="";return F("div",{class:he("mask")},[E,k&&F("div",{class:he("mask-message")},[d])])}},u=v=>{const{name:d,item:E,index:k,beforeDelete:A}=e;v.stopPropagation(),Rn(A,{args:[E,{name:d,index:k}],done:()=>o("delete")})},l=()=>o("preview"),g=()=>o("reupload"),_=()=>{if(e.deletable&&e.item.status!=="uploading"){const v=a["preview-delete"];return F("div",{role:"button",class:he("preview-delete",{shadow:!v}),tabindex:0,"aria-label":Is("delete"),onClick:u},[v?v():F(ut,{name:"cross",class:he("preview-delete-icon")},null)])}},h=()=>{if(a["preview-cover"]){const{index:v,item:d}=e;return F("div",{class:he("preview-cover")},[a["preview-cover"](Et({index:v},d))])}},y=()=>{const{item:v,lazyLoad:d,imageFit:E,previewSize:k,reupload:A}=e;return Bn(v)?F(zn,{fit:E,src:v.objectUrl||v.content||v.url,class:he("preview-image"),width:Array.isArray(k)?k[0]:k,height:Array.isArray(k)?k[1]:k,lazyLoad:d,onClick:A?g:l},{default:h}):F("div",{class:he("file"),style:An(e.previewSize)},[F(ut,{class:he("file-icon"),name:"description"},null),F("div",{class:[he("file-name"),"van-ellipsis"]},[v.file?v.file.name:v.url]),h()])};return()=>F("div",{class:he("preview")},[y(),s(),_()])}});const js={name:Be(""),accept:Xe("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:Be(1/0),imageFit:Xe("cover"),resultType:Xe("dataUrl"),uploadIcon:Xe("photograph"),uploadText:String,deletable:_e,reupload:Boolean,afterRead:Function,showUpload:_e,modelValue:In(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:_e,previewOptions:Object,previewFullImage:_e,maxSize:{type:[Number,String,Function],default:1/0}};var Fs=xe({name:xs,props:js,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:o,slots:a}){const s=te(),u=[],l=te(-1),g=te(!1),_=(x=e.modelValue.length)=>({name:e.name,index:x}),h=()=>{s.value&&(s.value.value="")},y=x=>{if(h(),Nn(x,e.maxSize))if(Array.isArray(x)){const N=Rs(x,e.maxSize);if(x=N.valid,o("oversize",N.invalid,_()),!x.length)return}else{o("oversize",x,_());return}if(x=Ot(x),l.value>-1){const N=[...e.modelValue];N.splice(l.value,1,x),o("update:modelValue",N),l.value=-1}else o("update:modelValue",[...e.modelValue,...Dn(x)]);e.afterRead&&e.afterRead(x,_())},v=x=>{const{maxCount:N,modelValue:Z,resultType:G}=e;if(Array.isArray(x)){const V=+N-Z.length;x.length>V&&(x=x.slice(0,V)),Promise.all(x.map(be=>cn(be,G))).then(be=>{const Ee=x.map((Oe,D)=>{const z={file:Oe,status:"",message:"",objectUrl:URL.createObjectURL(Oe)};return be[D]&&(z.content=be[D]),z});y(Ee)})}else cn(x,G).then(V=>{const be={file:x,status:"",message:"",objectUrl:URL.createObjectURL(x)};V&&(be.content=V),y(be)})},d=x=>{const{files:N}=x.target;if(e.disabled||!N||!N.length)return;const Z=N.length===1?N[0]:[].slice.call(N);if(e.beforeRead){const G=e.beforeRead(Z,_());if(!G){h();return}if(Wi(G)){G.then(V=>{v(V||Z)}).catch(h);return}}v(Z)};let E;const k=()=>o("closePreview"),A=x=>{if(e.previewFullImage){const N=e.modelValue.filter(Bn),Z=N.map(G=>(G.objectUrl&&!G.url&&G.status!=="failed"&&(G.url=G.objectUrl,u.push(G.url)),G.url)).filter(Boolean);E=ks(Et({images:Z,startPosition:N.indexOf(x),onClose:k},e.previewOptions))}},q=()=>{E&&E.close()},P=(x,N)=>{const Z=e.modelValue.slice(0);Z.splice(N,1),o("update:modelValue",Z),o("delete",x,_(N))},Y=x=>{g.value=!0,l.value=x,vt(()=>fe())},W=()=>{g.value||(l.value=-1),g.value=!1},w=(x,N)=>{const Z=["imageFit","deletable","reupload","previewSize","beforeDelete"],G=Et(ct(e,Z),ct(x,Z,!0));return F(Ms,ht({item:x,index:N,onClick:()=>o(e.reupload?"clickReupload":"clickPreview",x,_(N)),onDelete:()=>P(x,N),onPreview:()=>A(x),onReupload:()=>Y(N)},ct(e,["name","lazyLoad"]),G),ct(a,["preview-cover","preview-delete"]))},O=()=>{if(e.previewImage)return e.modelValue.map(w)},T=x=>o("clickUpload",x),re=()=>{const x=e.modelValue.length<+e.maxCount,N=e.readonly?null:F("input",{ref:s,type:"file",class:he("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&l.value===-1,disabled:e.disabled,onChange:d,onClick:W},null);return a.default?Pe(F("div",{class:he("input-wrapper"),onClick:T},[a.default(),N]),[[_r,x]]):Pe(F("div",{class:he("upload",{readonly:e.readonly}),style:An(e.previewSize),onClick:T},[F(ut,{name:e.uploadIcon,class:he("upload-icon")},null),e.uploadText&&F("span",{class:he("upload-text")},[e.uploadText]),N]),[[_r,e.showUpload&&x]])},fe=()=>{s.value&&!e.disabled&&s.value.click()};return Sr(()=>{u.forEach(x=>URL.revokeObjectURL(x))}),kt({chooseFile:fe,reuploadFile:Y,closeImagePreview:q}),En(()=>e.modelValue),()=>F("div",{class:he()},[F("div",{class:he("wrapper",{disabled:e.disabled})},[O(),re()])])}});const Us=rt(Fs),Ls=e=>Tr({url:"/watermeter/sb/info/yh/get/yhbh",params:e}),Ws=e=>Pr({url:"/file/server/uploadFile",data:e}),un=e=>Tr({url:"/watermeter/sb/info/get/SbbhOrSbNo",params:e}),zs=e=>Tr({url:"/customer/sbKjSetting/list/all",params:e}),Vs=e=>Pr({url:"/watermeter/work/order/task/complete",data:e}),Ns=e=>Pr({url:"/watermeter/work/order/task/fail",data:e});var Hn=(e,o,a)=>{if(!o.has(e))throw TypeError("Cannot "+a)},dn=(e,o,a)=>(Hn(e,o,"read from private field"),a?a.call(e):o.get(e)),Bs=(e,o,a)=>{if(o.has(e))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(e):o.set(e,a)},Hs=(e,o,a,s)=>(Hn(e,o,"write to private field"),o.set(e,a),a);const Yn=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],Ys=[...Yn,["unknown"]].map(e=>e[0]),Gt=new Map(Yn);function qs(e){for(const[o,a]of Gt)if(e===a)return o;return"unknown"}function Xs(e){if(qn(e))return{width:e.naturalWidth,height:e.naturalHeight};if(Xn(e))return{width:e.width.baseVal.value,height:e.height.baseVal.value};if(Gn(e))return{width:e.videoWidth,height:e.videoHeight};if(Zn(e))return{width:e.width,height:e.height};if(Qn(e))return{width:e.displayWidth,height:e.displayHeight};if(Jn(e))return{width:e.width,height:e.height};if(Kn(e))return{width:e.width,height:e.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function qn(e){try{return e instanceof HTMLImageElement}catch{return!1}}function Xn(e){try{return e instanceof SVGImageElement}catch{return!1}}function Gn(e){try{return e instanceof HTMLVideoElement}catch{return!1}}function Jn(e){try{return e instanceof HTMLCanvasElement}catch{return!1}}function Zn(e){try{return e instanceof ImageBitmap}catch{return!1}}function Kn(e){try{return e instanceof OffscreenCanvas}catch{return!1}}function Qn(e){try{return e instanceof VideoFrame}catch{return!1}}function ea(e){try{return e instanceof Blob}catch{return!1}}function Gs(e){try{return e instanceof ImageData}catch{return!1}}function Js(e,o){try{const a=new OffscreenCanvas(e,o);if(a.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return a;throw void 0}catch{const s=document.createElement("canvas");return s.width=e,s.height=o,s}}async function ta(e){if(qn(e)&&!await el(e))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Xn(e)&&!await tl(e))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Qn(e)&&rl(e))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(Gn(e)&&(e.readyState===0||e.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(Zn(e)&&al(e))throw new DOMException("The image source is detached.","InvalidStateError");const{width:o,height:a}=Xs(e);if(o===0||a===0)return null;const s=Js(o,a).getContext("2d");s.drawImage(e,0,0);try{return s.getImageData(0,0,o,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Zs(e){let o;try{if(globalThis.createImageBitmap)o=await createImageBitmap(e);else if(globalThis.Image){o=new Image;let a="";try{a=URL.createObjectURL(e),o.src=a,await o.decode()}finally{URL.revokeObjectURL(a)}}else return e}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await ta(o)}function Ks(e){const{width:o,height:a}=e;if(o===0||a===0)return null;const s=e.getContext("2d");try{return s.getImageData(0,0,o,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Qs(e){if(ea(e))return await Zs(e);if(Gs(e)){if(nl(e))throw new DOMException("The image data has been detached.","InvalidStateError");return e}return Jn(e)||Kn(e)?Ks(e):await ta(e)}async function el(e){try{return await e.decode(),!0}catch{return!1}}async function tl(e){var o;try{return await((o=e.decode)==null?void 0:o.call(e)),!0}catch{return!1}}function rl(e){return e.format===null}function nl(e){return e.data.buffer.byteLength===0}function al(e){return e.width===0&&e.height===0}function fn(e,o){return e instanceof DOMException?new DOMException(`${o}: ${e.message}`,e.name):e instanceof Error?new e.constructor(`${o}: ${e.message}`):new Error(`${o}: ${e}`)}const vn=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function ol(e){return e.join("|")}function il(e){const o=hn(e);let a=0,s=vn.length-1;for(;a<=s;){const u=Math.floor((a+s)/2),l=vn[u],g=hn(l);if(g===o)return l;g<o?a=u+1:s=u-1}return"None"}function hn(e){return e.toLowerCase().replace(/_-\[\]/g,"")}function sl(e,o){return e.Binarizer[o]}function ll(e,o){return e.CharacterSet[o]}const cl=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function ul(e){return cl[e.value]}function dl(e,o){return e.EanAddOnSymbol[o]}function fl(e,o){return e.TextMode[o]}const mt={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function ra(e,o){return{...o,formats:ol(o.formats),binarizer:sl(e,o.binarizer),eanAddOnSymbol:dl(e,o.eanAddOnSymbol),textMode:fl(e,o.textMode),characterSet:ll(e,o.characterSet)}}function na(e){return{...e,format:il(e.format),eccLevel:e.eccLevel,contentType:ul(e.contentType)}}const vl={locateFile:(e,o)=>{const a=e.match(/_(.+?)\.wasm$/);return a?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${a[1]}/${e}`:o+e}};let mn=new WeakMap;function $r(e,o){var a;const s=mn.get(e);if(s!=null&&s.modulePromise&&o===void 0)return s.modulePromise;const u=(a=s==null?void 0:s.moduleOverrides)!=null?a:vl,l=e({...u});return mn.set(e,{moduleOverrides:u,modulePromise:l}),l}async function hl(e,o,a=mt){const s={...mt,...a},u=await $r(e),{size:l}=o,g=new Uint8Array(await o.arrayBuffer()),_=u._malloc(l);u.HEAPU8.set(g,_);const h=u.readBarcodesFromImage(_,l,ra(u,s));u._free(_);const y=[];for(let v=0;v<h.size();++v)y.push(na(h.get(v)));return y}async function ml(e,o,a=mt){const s={...mt,...a},u=await $r(e),{data:l,width:g,height:_,data:{byteLength:h}}=o,y=u._malloc(h);u.HEAPU8.set(l,y);const v=u.readBarcodesFromPixmap(y,g,_,ra(u,s));u._free(y);const d=[];for(let E=0;E<v.size();++E)d.push(na(v.get(E)));return d}({...mt,formats:[...mt.formats]});var Er=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(o={}){var a=o,s,u;a.ready=new Promise((t,r)=>{s=t,u=r});var l=Object.assign({},a),g="./this.program",_=typeof window=="object",h=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var y="";function v(t){return a.locateFile?a.locateFile(t,y):y+t}var d;(_||h)&&(h?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),e&&(y=e),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",h&&(d=t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)})),a.print||console.log.bind(console);var E=a.printErr||console.error.bind(console);Object.assign(a,l),l=null,a.arguments&&a.arguments,a.thisProgram&&(g=a.thisProgram),a.quit&&a.quit;var k;a.wasmBinary&&(k=a.wasmBinary),typeof WebAssembly!="object"&&X("no native wasm support detected");var A,q=!1,P,Y,W,w,O,T,re,fe;function x(){var t=A.buffer;a.HEAP8=P=new Int8Array(t),a.HEAP16=W=new Int16Array(t),a.HEAPU8=Y=new Uint8Array(t),a.HEAPU16=w=new Uint16Array(t),a.HEAP32=O=new Int32Array(t),a.HEAPU32=T=new Uint32Array(t),a.HEAPF32=re=new Float32Array(t),a.HEAPF64=fe=new Float64Array(t)}var N=[],Z=[],G=[];function V(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Oe(a.preRun.shift());Kt(N)}function be(){Kt(Z)}function Ee(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)z(a.postRun.shift());Kt(G)}function Oe(t){N.unshift(t)}function D(t){Z.unshift(t)}function z(t){G.unshift(t)}var B=0,ee=null;function we(t){var r;B++,(r=a.monitorRunDependencies)===null||r===void 0||r.call(a,B)}function I(t){var r;if(B--,(r=a.monitorRunDependencies)===null||r===void 0||r.call(a,B),B==0&&ee){var n=ee;ee=null,n()}}function X(t){var r;(r=a.onAbort)===null||r===void 0||r.call(a,t),t="Aborted("+t+")",E(t),q=!0,t+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(t);throw u(n),n}var Q="data:application/octet-stream;base64,",Ce=t=>t.startsWith(Q),oe;oe="zxing_reader.wasm",Ce(oe)||(oe=v(oe));function Ie(t){if(t==oe&&k)return new Uint8Array(k);if(d)return d(t);throw"both async and sync fetching of the wasm failed"}function Ke(t){return!k&&(_||h)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw"failed to load wasm binary file at '"+t+"'";return r.arrayBuffer()}).catch(()=>Ie(t)):Promise.resolve().then(()=>Ie(t))}function xt(t,r,n){return Ke(t).then(i=>WebAssembly.instantiate(i,r)).then(i=>i).then(n,i=>{E(`failed to asynchronously prepare wasm: ${i}`),X(i)})}function ba(t,r,n,i){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!Ce(r)&&typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(c=>{var f=WebAssembly.instantiateStreaming(c,n);return f.then(i,function(m){return E(`wasm streaming compile failed: ${m}`),E("falling back to ArrayBuffer instantiation"),xt(r,n,i)})}):xt(r,n,i)}function wa(){var t={a:li};function r(i,c){return de=i.exports,A=de.ia,x(),Fr=de.ma,D(de.ja),I(),de}we();function n(i){r(i.instance)}if(a.instantiateWasm)try{return a.instantiateWasm(t,r)}catch(i){E(`Module.instantiateWasm callback failed with error: ${i}`),u(i)}return ba(k,oe,t,n).catch(u),{}}var Kt=t=>{for(;t.length>0;)t.shift()(a)};a.noExitRuntime;var It=[],Rt=0,Ca=t=>{var r=new Qt(t);return r.get_caught()||(r.set_caught(!0),Rt--),r.set_rethrown(!1),It.push(r),Zr(r.excPtr),r.get_exception_ptr()},Ue=0,_a=()=>{ne(0,0);var t=It.pop();Jr(t.excPtr),Ue=0};function Qt(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(r){T[this.ptr+4>>2]=r},this.get_type=function(){return T[this.ptr+4>>2]},this.set_destructor=function(r){T[this.ptr+8>>2]=r},this.get_destructor=function(){return T[this.ptr+8>>2]},this.set_caught=function(r){r=r?1:0,P[this.ptr+12>>0]=r},this.get_caught=function(){return P[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,P[this.ptr+13>>0]=r},this.get_rethrown=function(){return P[this.ptr+13>>0]!=0},this.init=function(r,n){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(n)},this.set_adjusted_ptr=function(r){T[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return T[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=Qr(this.get_type());if(r)return T[this.excPtr>>2];var n=this.get_adjusted_ptr();return n!==0?n:this.excPtr}}var Sa=t=>{throw Ue||(Ue=t),Ue},er=t=>{var r=Ue;if(!r)return St(0),0;var n=new Qt(r);n.set_adjusted_ptr(r);var i=n.get_type();if(!i)return St(0),r;for(var c in t){var f=t[c];if(f===0||f===i)break;var m=n.ptr+16;if(Kr(f,i,m))return St(f),r}return St(i),r},Ta=()=>er([]),Pa=t=>er([t]),$a=(t,r)=>er([t,r]),Ea=()=>{var t=It.pop();t||X("no exception to throw");var r=t.excPtr;throw t.get_rethrown()||(It.push(t),t.set_rethrown(!0),t.set_caught(!1),Rt++),Ue=r,Ue},Oa=(t,r,n)=>{var i=new Qt(t);throw i.init(r,n),Ue=t,Rt++,Ue},ka=()=>Rt,Dt={},tr=t=>{for(;t.length;){var r=t.pop(),n=t.pop();n(r)}};function rr(t){return this.fromWireType(O[t>>2])}var nt={},Qe={},At={},Or,Mt=t=>{throw new Or(t)},et=(t,r,n)=>{t.forEach(function(p){At[p]=r});function i(p){var b=n(p);b.length!==t.length&&Mt("Mismatched type converter count");for(var S=0;S<t.length;++S)Re(t[S],b[S])}var c=new Array(r.length),f=[],m=0;r.forEach((p,b)=>{Qe.hasOwnProperty(p)?c[b]=Qe[p]:(f.push(p),nt.hasOwnProperty(p)||(nt[p]=[]),nt[p].push(()=>{c[b]=Qe[p],++m,m===f.length&&i(c)}))}),f.length===0&&i(c)},xa=t=>{var r=Dt[t];delete Dt[t];var n=r.rawConstructor,i=r.rawDestructor,c=r.fields,f=c.map(m=>m.getterReturnType).concat(c.map(m=>m.setterArgumentType));et([t],f,m=>{var p={};return c.forEach((b,S)=>{var $=b.fieldName,U=m[S],L=b.getter,H=b.getterContext,ae=m[S+c.length],ce=b.setter,K=b.setterContext;p[$]={read:ge=>U.fromWireType(L(H,ge)),write:(ge,C)=>{var R=[];ce(K,ge,ae.toWireType(R,C)),tr(R)}}}),[{name:r.name,fromWireType:b=>{var S={};for(var $ in p)S[$]=p[$].read(b);return i(b),S},toWireType:(b,S)=>{for(var $ in p)if(!($ in S))throw new TypeError(`Missing field: "${$}"`);var U=n();for($ in p)p[$].write(U,S[$]);return b!==null&&b.push(i,U),U},argPackAdvance:De,readValueFromPointer:rr,destructorFunction:i}]})},Ia=(t,r,n,i,c)=>{},Ra=()=>{for(var t=new Array(256),r=0;r<256;++r)t[r]=String.fromCharCode(r);kr=t},kr,pe=t=>{for(var r="",n=t;Y[n];)r+=kr[Y[n++]];return r},at,J=t=>{throw new at(t)};function Da(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i=r.name;if(t||J(`type "${i}" must have a positive integer typeid pointer`),Qe.hasOwnProperty(t)){if(n.ignoreDuplicateRegistrations)return;J(`Cannot register type '${i}' twice`)}if(Qe[t]=r,delete At[t],nt.hasOwnProperty(t)){var c=nt[t];delete nt[t],c.forEach(f=>f())}}function Re(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Da(t,r,n)}var De=8,Aa=(t,r,n,i)=>{r=pe(r),Re(t,{name:r,fromWireType:function(c){return!!c},toWireType:function(c,f){return f?n:i},argPackAdvance:De,readValueFromPointer:function(c){return this.fromWireType(Y[c])},destructorFunction:null})},Ma=t=>({count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}),nr=t=>{function r(n){return n.$$.ptrType.registeredClass.name}J(r(t)+" instance already deleted")},ar=!1,xr=t=>{},ja=t=>{t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)},Ir=t=>{t.count.value-=1;var r=t.count.value===0;r&&ja(t)},Rr=(t,r,n)=>{if(r===n)return t;if(n.baseClass===void 0)return null;var i=Rr(t,r,n.baseClass);return i===null?null:n.downcast(i)},Dr={},Fa=()=>Object.keys(bt).length,Ua=()=>{var t=[];for(var r in bt)bt.hasOwnProperty(r)&&t.push(bt[r]);return t},gt=[],or=()=>{for(;gt.length;){var t=gt.pop();t.$$.deleteScheduled=!1,t.delete()}},yt,La=t=>{yt=t,gt.length&&yt&&yt(or)},Wa=()=>{a.getInheritedInstanceCount=Fa,a.getLiveInheritedInstances=Ua,a.flushPendingDeletes=or,a.setDelayFunction=La},bt={},za=(t,r)=>{for(r===void 0&&J("ptr should not be undefined");t.baseClass;)r=t.upcast(r),t=t.baseClass;return r},Va=(t,r)=>(r=za(t,r),bt[r]),jt=(t,r)=>{(!r.ptrType||!r.ptr)&&Mt("makeClassHandle requires ptr and ptrType");var n=!!r.smartPtrType,i=!!r.smartPtr;return n!==i&&Mt("Both smartPtrType and smartPtr must be specified"),r.count={value:1},wt(Object.create(t,{$$:{value:r,writable:!0}}))};function Na(t){var r=this.getPointee(t);if(!r)return this.destructor(t),null;var n=Va(this.registeredClass,r);if(n!==void 0){if(n.$$.count.value===0)return n.$$.ptr=r,n.$$.smartPtr=t,n.clone();var i=n.clone();return this.destructor(t),i}function c(){return this.isSmartPointer?jt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:t}):jt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var f=this.registeredClass.getActualType(r),m=Dr[f];if(!m)return c.call(this);var p;this.isConst?p=m.constPointerType:p=m.pointerType;var b=Rr(r,this.registeredClass,p.registeredClass);return b===null?c.call(this):this.isSmartPointer?jt(p.registeredClass.instancePrototype,{ptrType:p,ptr:b,smartPtrType:this,smartPtr:t}):jt(p.registeredClass.instancePrototype,{ptrType:p,ptr:b})}var wt=t=>typeof FinalizationRegistry>"u"?(wt=r=>r,t):(ar=new FinalizationRegistry(r=>{Ir(r.$$)}),wt=r=>{var n=r.$$,i=!!n.smartPtr;if(i){var c={$$:n};ar.register(r,c,r)}return r},xr=r=>ar.unregister(r),wt(t)),Ba=()=>{Object.assign(Ft.prototype,{isAliasOf(t){if(!(this instanceof Ft)||!(t instanceof Ft))return!1;var r=this.$$.ptrType.registeredClass,n=this.$$.ptr;t.$$=t.$$;for(var i=t.$$.ptrType.registeredClass,c=t.$$.ptr;r.baseClass;)n=r.upcast(n),r=r.baseClass;for(;i.baseClass;)c=i.upcast(c),i=i.baseClass;return r===i&&n===c},clone(){if(this.$$.ptr||nr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=wt(Object.create(Object.getPrototypeOf(this),{$$:{value:Ma(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},delete(){this.$$.ptr||nr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&J("Object already scheduled for deletion"),xr(this),Ir(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||nr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&J("Object already scheduled for deletion"),gt.push(this),gt.length===1&&yt&&yt(or),this.$$.deleteScheduled=!0,this}})};function Ft(){}var Ct=(t,r)=>Object.defineProperty(r,"name",{value:t}),Ar=(t,r,n)=>{if(t[r].overloadTable===void 0){var i=t[r];t[r]=function(){return t[r].overloadTable.hasOwnProperty(arguments.length)||J(`Function '${n}' called with an invalid number of arguments (${arguments.length}) - expects one of (${t[r].overloadTable})!`),t[r].overloadTable[arguments.length].apply(this,arguments)},t[r].overloadTable=[],t[r].overloadTable[i.argCount]=i}},ir=(t,r,n)=>{a.hasOwnProperty(t)?((n===void 0||a[t].overloadTable!==void 0&&a[t].overloadTable[n]!==void 0)&&J(`Cannot register public name '${t}' twice`),Ar(a,t,t),a.hasOwnProperty(n)&&J(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`),a[t].overloadTable[n]=r):(a[t]=r,n!==void 0&&(a[t].numArguments=n))},Ha=48,Ya=57,qa=t=>{if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var r=t.charCodeAt(0);return r>=Ha&&r<=Ya?`_${t}`:t};function Xa(t,r,n,i,c,f,m,p){this.name=t,this.constructor=r,this.instancePrototype=n,this.rawDestructor=i,this.baseClass=c,this.getActualType=f,this.upcast=m,this.downcast=p,this.pureVirtualFunctions=[]}var sr=(t,r,n)=>{for(;r!==n;)r.upcast||J(`Expected null or instance of ${n.name}, got an instance of ${r.name}`),t=r.upcast(t),r=r.baseClass;return t};function Ga(t,r){if(r===null)return this.isReference&&J(`null is not a valid ${this.name}`),0;r.$$||J(`Cannot pass "${fr(r)}" as a ${this.name}`),r.$$.ptr||J(`Cannot pass deleted object as a pointer of type ${this.name}`);var n=r.$$.ptrType.registeredClass,i=sr(r.$$.ptr,n,this.registeredClass);return i}function Ja(t,r){var n;if(r===null)return this.isReference&&J(`null is not a valid ${this.name}`),this.isSmartPointer?(n=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,n),n):0;(!r||!r.$$)&&J(`Cannot pass "${fr(r)}" as a ${this.name}`),r.$$.ptr||J(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&r.$$.ptrType.isConst&&J(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);var i=r.$$.ptrType.registeredClass;if(n=sr(r.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&J("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?n=r.$$.smartPtr:J(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:n=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)n=r.$$.smartPtr;else{var c=r.clone();n=this.rawShare(n,Le.toHandle(()=>c.delete())),t!==null&&t.push(this.rawDestructor,n)}break;default:J("Unsupporting sharing policy")}return n}function Za(t,r){if(r===null)return this.isReference&&J(`null is not a valid ${this.name}`),0;r.$$||J(`Cannot pass "${fr(r)}" as a ${this.name}`),r.$$.ptr||J(`Cannot pass deleted object as a pointer of type ${this.name}`),r.$$.ptrType.isConst&&J(`Cannot convert argument of type ${r.$$.ptrType.name} to parameter type ${this.name}`);var n=r.$$.ptrType.registeredClass,i=sr(r.$$.ptr,n,this.registeredClass);return i}function Mr(t){return this.fromWireType(T[t>>2])}var Ka=()=>{Object.assign(Ut.prototype,{getPointee(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t},destructor(t){var r;(r=this.rawDestructor)===null||r===void 0||r.call(this,t)},argPackAdvance:De,readValueFromPointer:Mr,deleteObject(t){t!==null&&t.delete()},fromWireType:Na})};function Ut(t,r,n,i,c,f,m,p,b,S,$){this.name=t,this.registeredClass=r,this.isReference=n,this.isConst=i,this.isSmartPointer=c,this.pointeeType=f,this.sharingPolicy=m,this.rawGetPointee=p,this.rawConstructor=b,this.rawShare=S,this.rawDestructor=$,!c&&r.baseClass===void 0?i?(this.toWireType=Ga,this.destructorFunction=null):(this.toWireType=Za,this.destructorFunction=null):this.toWireType=Ja}var jr=(t,r,n)=>{a.hasOwnProperty(t)||Mt("Replacing nonexistant public symbol"),a[t].overloadTable!==void 0&&n!==void 0?a[t].overloadTable[n]=r:(a[t]=r,a[t].argCount=n)},Qa=(t,r,n)=>{var i=a["dynCall_"+t];return n&&n.length?i.apply(null,[r].concat(n)):i.call(null,r)},Lt=[],Fr,ie=t=>{var r=Lt[t];return r||(t>=Lt.length&&(Lt.length=t+1),Lt[t]=r=Fr.get(t)),r},eo=(t,r,n)=>{if(t.includes("j"))return Qa(t,r,n);var i=ie(r).apply(null,n);return i},to=(t,r)=>{var n=[];return function(){return n.length=0,Object.assign(n,arguments),eo(t,r,n)}},ke=(t,r)=>{t=pe(t);function n(){return t.includes("j")?to(t,r):ie(r)}var i=n();return typeof i!="function"&&J(`unknown function pointer with signature ${t}: ${r}`),i},ro=(t,r)=>{var n=Ct(r,function(i){this.name=r,this.message=i;var c=new Error(i).stack;c!==void 0&&(this.stack=this.toString()+`
`+c.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},n},Ur,Lr=t=>{var r=Gr(t),n=pe(r);return We(r),n},Wt=(t,r)=>{var n=[],i={};function c(f){if(!i[f]&&!Qe[f]){if(At[f]){At[f].forEach(c);return}n.push(f),i[f]=!0}}throw r.forEach(c),new Ur(`${t}: `+n.map(Lr).join([", "]))},no=(t,r,n,i,c,f,m,p,b,S,$,U,L)=>{$=pe($),f=ke(c,f),p&&(p=ke(m,p)),S&&(S=ke(b,S)),L=ke(U,L);var H=qa($);ir(H,function(){Wt(`Cannot construct ${$} due to unbound types`,[i])}),et([t,r,n],i?[i]:[],function(ae){ae=ae[0];var ce,K;i?(ce=ae.registeredClass,K=ce.instancePrototype):K=Ft.prototype;var ge=Ct($,function(){if(Object.getPrototypeOf(this)!==C)throw new at("Use 'new' to construct "+$);if(R.constructor_body===void 0)throw new at($+" has no accessible constructor");var nn=R.constructor_body[arguments.length];if(nn===void 0)throw new at(`Tried to invoke ctor of ${$} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(R.constructor_body).toString()}) parameters instead!`);return nn.apply(this,arguments)}),C=Object.create(K,{constructor:{value:ge}});ge.prototype=C;var R=new Xa($,ge,C,L,ce,f,p,S);if(R.baseClass){var ue,ve;(ve=(ue=R.baseClass).__derivedClasses)!==null&&ve!==void 0||(ue.__derivedClasses=[]),R.baseClass.__derivedClasses.push(R)}var ot=new Ut($,R,!0,!1,!1),Nt=new Ut($+"*",R,!1,!1,!1),rn=new Ut($+" const*",R,!1,!0,!1);return Dr[t]={pointerType:Nt,constPointerType:rn},jr(H,ge),[ot,Nt,rn]})},lr=(t,r)=>{for(var n=[],i=0;i<t;i++)n.push(T[r+i*4>>2]);return n};function ao(t){for(var r=1;r<t.length;++r)if(t[r]!==null&&t[r].destructorFunction===void 0)return!0;return!1}function cr(t,r,n,i,c,f){var m=r.length;m<2&&J("argTypes array size mismatch! Must at least get return value and 'this' types!");var p=r[1]!==null&&n!==null,b=ao(r),S=r[0].name!=="void",$=m-2,U=new Array($),L=[],H=[],ae=function(){arguments.length!==$&&J(`function ${t} called with ${arguments.length} arguments, expected ${$}`),H.length=0;var ce;L.length=p?2:1,L[0]=c,p&&(ce=r[1].toWireType(H,this),L[1]=ce);for(var K=0;K<$;++K)U[K]=r[K+2].toWireType(H,arguments[K]),L.push(U[K]);var ge=i.apply(null,L);function C(R){if(b)tr(H);else for(var ue=p?1:2;ue<r.length;ue++){var ve=ue===1?ce:U[ue-2];r[ue].destructorFunction!==null&&r[ue].destructorFunction(ve)}if(S)return r[0].fromWireType(R)}return C(ge)};return Ct(t,ae)}var oo=(t,r,n,i,c,f)=>{var m=lr(r,n);c=ke(i,c),et([],[t],function(p){p=p[0];var b=`constructor ${p.name}`;if(p.registeredClass.constructor_body===void 0&&(p.registeredClass.constructor_body=[]),p.registeredClass.constructor_body[r-1]!==void 0)throw new at(`Cannot register multiple constructors with identical number of parameters (${r-1}) for class '${p.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return p.registeredClass.constructor_body[r-1]=()=>{Wt(`Cannot construct ${p.name} due to unbound types`,m)},et([],m,S=>(S.splice(1,0,null),p.registeredClass.constructor_body[r-1]=cr(b,S,null,c,f),[])),[]})},Wr=t=>{t=t.trim();const r=t.indexOf("(");return r!==-1?t.substr(0,r):t},io=(t,r,n,i,c,f,m,p,b)=>{var S=lr(n,i);r=pe(r),r=Wr(r),f=ke(c,f),et([],[t],function($){$=$[0];var U=`${$.name}.${r}`;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),p&&$.registeredClass.pureVirtualFunctions.push(r);function L(){Wt(`Cannot call ${U} due to unbound types`,S)}var H=$.registeredClass.instancePrototype,ae=H[r];return ae===void 0||ae.overloadTable===void 0&&ae.className!==$.name&&ae.argCount===n-2?(L.argCount=n-2,L.className=$.name,H[r]=L):(Ar(H,r,U),H[r].overloadTable[n-2]=L),et([],S,function(ce){var K=cr(U,ce,$,f,m);return H[r].overloadTable===void 0?(K.argCount=n-2,H[r]=K):H[r].overloadTable[n-2]=K,[]}),[]})};function so(){Object.assign(zr.prototype,{get(t){return this.allocated[t]},has(t){return this.allocated[t]!==void 0},allocate(t){var r=this.freelist.pop()||this.allocated.length;return this.allocated[r]=t,r},free(t){this.allocated[t]=void 0,this.freelist.push(t)}})}function zr(){this.allocated=[void 0],this.freelist=[]}var Te=new zr,ur=t=>{t>=Te.reserved&&--Te.get(t).refcount===0&&Te.free(t)},lo=()=>{for(var t=0,r=Te.reserved;r<Te.allocated.length;++r)Te.allocated[r]!==void 0&&++t;return t},co=()=>{Te.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Te.reserved=Te.allocated.length,a.count_emval_handles=lo},Le={toValue:t=>(t||J("Cannot use deleted val. handle = "+t),Te.get(t).value),toHandle:t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Te.allocate({refcount:1,value:t})}}},uo=(t,r)=>{r=pe(r),Re(t,{name:r,fromWireType:n=>{var i=Le.toValue(n);return ur(n),i},toWireType:(n,i)=>Le.toHandle(i),argPackAdvance:De,readValueFromPointer:rr,destructorFunction:null})},fo=(t,r,n)=>{switch(r){case 1:return n?function(i){return this.fromWireType(P[i>>0])}:function(i){return this.fromWireType(Y[i>>0])};case 2:return n?function(i){return this.fromWireType(W[i>>1])}:function(i){return this.fromWireType(w[i>>1])};case 4:return n?function(i){return this.fromWireType(O[i>>2])}:function(i){return this.fromWireType(T[i>>2])};default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},vo=(t,r,n,i)=>{r=pe(r);function c(){}c.values={},Re(t,{name:r,constructor:c,fromWireType:function(f){return this.constructor.values[f]},toWireType:(f,m)=>m.value,argPackAdvance:De,readValueFromPointer:fo(r,n,i),destructorFunction:null}),ir(r,c)},dr=(t,r)=>{var n=Qe[t];return n===void 0&&J(r+" has unknown type "+Lr(t)),n},ho=(t,r,n)=>{var i=dr(t,"enum");r=pe(r);var c=i.constructor,f=Object.create(i.constructor.prototype,{value:{value:n},constructor:{value:Ct(`${i.name}_${r}`,function(){})}});c.values[n]=f,c[r]=f},fr=t=>{if(t===null)return"null";var r=typeof t;return r==="object"||r==="array"||r==="function"?t.toString():""+t},mo=(t,r)=>{switch(r){case 4:return function(n){return this.fromWireType(re[n>>2])};case 8:return function(n){return this.fromWireType(fe[n>>3])};default:throw new TypeError(`invalid float width (${r}): ${t}`)}},po=(t,r,n)=>{r=pe(r),Re(t,{name:r,fromWireType:i=>i,toWireType:(i,c)=>c,argPackAdvance:De,readValueFromPointer:mo(r,n),destructorFunction:null})},go=(t,r,n,i,c,f,m)=>{var p=lr(r,n);t=pe(t),t=Wr(t),c=ke(i,c),ir(t,function(){Wt(`Cannot call ${t} due to unbound types`,p)},r-1),et([],p,function(b){var S=[b[0],null].concat(b.slice(1));return jr(t,cr(t,S,null,c,f),r-1),[]})},yo=(t,r,n)=>{switch(r){case 1:return n?i=>P[i>>0]:i=>Y[i>>0];case 2:return n?i=>W[i>>1]:i=>w[i>>1];case 4:return n?i=>O[i>>2]:i=>T[i>>2];default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},bo=(t,r,n,i,c)=>{r=pe(r);var f=$=>$;if(i===0){var m=32-8*n;f=$=>$<<m>>>m}var p=r.includes("unsigned"),b=($,U)=>{},S;p?S=function($,U){return b(U,this.name),U>>>0}:S=function($,U){return b(U,this.name),U},Re(t,{name:r,fromWireType:f,toWireType:S,argPackAdvance:De,readValueFromPointer:yo(r,n,i!==0),destructorFunction:null})},wo=(t,r,n)=>{var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c=i[r];function f(m){var p=T[m>>2],b=T[m+4>>2];return new c(P.buffer,b,p)}n=pe(n),Re(t,{name:n,fromWireType:f,argPackAdvance:De,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})},Vr=(t,r,n,i)=>{if(!(i>0))return 0;for(var c=n,f=n+i-1,m=0;m<t.length;++m){var p=t.charCodeAt(m);if(p>=55296&&p<=57343){var b=t.charCodeAt(++m);p=65536+((p&1023)<<10)|b&1023}if(p<=127){if(n>=f)break;r[n++]=p}else if(p<=2047){if(n+1>=f)break;r[n++]=192|p>>6,r[n++]=128|p&63}else if(p<=65535){if(n+2>=f)break;r[n++]=224|p>>12,r[n++]=128|p>>6&63,r[n++]=128|p&63}else{if(n+3>=f)break;r[n++]=240|p>>18,r[n++]=128|p>>12&63,r[n++]=128|p>>6&63,r[n++]=128|p&63}}return r[n]=0,n-c},Co=(t,r,n)=>Vr(t,Y,r,n),Nr=t=>{for(var r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i<=127?r++:i<=2047?r+=2:i>=55296&&i<=57343?(r+=4,++n):r+=3}return r},Br=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,_o=(t,r,n)=>{for(var i=r+n,c=r;t[c]&&!(c>=i);)++c;if(c-r>16&&t.buffer&&Br)return Br.decode(t.subarray(r,c));for(var f="";r<c;){var m=t[r++];if(!(m&128)){f+=String.fromCharCode(m);continue}var p=t[r++]&63;if((m&224)==192){f+=String.fromCharCode((m&31)<<6|p);continue}var b=t[r++]&63;if((m&240)==224?m=(m&15)<<12|p<<6|b:m=(m&7)<<18|p<<12|b<<6|t[r++]&63,m<65536)f+=String.fromCharCode(m);else{var S=m-65536;f+=String.fromCharCode(55296|S>>10,56320|S&1023)}}return f},vr=(t,r)=>t?_o(Y,t,r):"",So=(t,r)=>{r=pe(r);var n=r==="std::string";Re(t,{name:r,fromWireType(i){var c=T[i>>2],f=i+4,m;if(n)for(var p=f,b=0;b<=c;++b){var S=f+b;if(b==c||Y[S]==0){var $=S-p,U=vr(p,$);m===void 0?m=U:(m+="\0",m+=U),p=S+1}}else{for(var L=new Array(c),b=0;b<c;++b)L[b]=String.fromCharCode(Y[f+b]);m=L.join("")}return We(i),m},toWireType(i,c){c instanceof ArrayBuffer&&(c=new Uint8Array(c));var f,m=typeof c=="string";m||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int8Array||J("Cannot pass non-string to std::string"),n&&m?f=Nr(c):f=c.length;var p=pr(4+f+1),b=p+4;if(T[p>>2]=f,n&&m)Co(c,b,f+1);else if(m)for(var S=0;S<f;++S){var $=c.charCodeAt(S);$>255&&(We(b),J("String has UTF-16 code units that do not fit in 8 bits")),Y[b+S]=$}else for(var S=0;S<f;++S)Y[b+S]=c[S];return i!==null&&i.push(We,p),p},argPackAdvance:De,readValueFromPointer:Mr,destructorFunction(i){We(i)}})},Hr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,To=(t,r)=>{for(var n=t,i=n>>1,c=i+r/2;!(i>=c)&&w[i];)++i;if(n=i<<1,n-t>32&&Hr)return Hr.decode(Y.subarray(t,n));for(var f="",m=0;!(m>=r/2);++m){var p=W[t+m*2>>1];if(p==0)break;f+=String.fromCharCode(p)}return f},Po=(t,r,n)=>{var i;if((i=n)!==null&&i!==void 0||(n=2147483647),n<2)return 0;n-=2;for(var c=r,f=n<t.length*2?n/2:t.length,m=0;m<f;++m){var p=t.charCodeAt(m);W[r>>1]=p,r+=2}return W[r>>1]=0,r-c},$o=t=>t.length*2,Eo=(t,r)=>{for(var n=0,i="";!(n>=r/4);){var c=O[t+n*4>>2];if(c==0)break;if(++n,c>=65536){var f=c-65536;i+=String.fromCharCode(55296|f>>10,56320|f&1023)}else i+=String.fromCharCode(c)}return i},Oo=(t,r,n)=>{var i;if((i=n)!==null&&i!==void 0||(n=2147483647),n<4)return 0;for(var c=r,f=c+n-4,m=0;m<t.length;++m){var p=t.charCodeAt(m);if(p>=55296&&p<=57343){var b=t.charCodeAt(++m);p=65536+((p&1023)<<10)|b&1023}if(O[r>>2]=p,r+=4,r+4>f)break}return O[r>>2]=0,r-c},ko=t=>{for(var r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=55296&&i<=57343&&++n,r+=4}return r},xo=(t,r,n)=>{n=pe(n);var i,c,f,m,p;r===2?(i=To,c=Po,m=$o,f=()=>w,p=1):r===4&&(i=Eo,c=Oo,m=ko,f=()=>T,p=2),Re(t,{name:n,fromWireType:b=>{for(var S=T[b>>2],$=f(),U,L=b+4,H=0;H<=S;++H){var ae=b+4+H*r;if(H==S||$[ae>>p]==0){var ce=ae-L,K=i(L,ce);U===void 0?U=K:(U+="\0",U+=K),L=ae+r}}return We(b),U},toWireType:(b,S)=>{typeof S!="string"&&J(`Cannot pass non-string to C++ string type ${n}`);var $=m(S),U=pr(4+$+r);return T[U>>2]=$>>p,c(S,U+4,$+r),b!==null&&b.push(We,U),U},argPackAdvance:De,readValueFromPointer:rr,destructorFunction(b){We(b)}})},Io=(t,r,n,i,c,f)=>{Dt[t]={name:pe(r),rawConstructor:ke(n,i),rawDestructor:ke(c,f),fields:[]}},Ro=(t,r,n,i,c,f,m,p,b,S)=>{Dt[t].fields.push({fieldName:pe(r),getterReturnType:n,getter:ke(i,c),getterContext:f,setterArgumentType:m,setter:ke(p,b),setterContext:S})},Do=(t,r)=>{r=pe(r),Re(t,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:()=>{},toWireType:(n,i)=>{}})},hr=[],Ao=(t,r,n,i)=>(t=hr[t],r=Le.toValue(r),t(null,r,n,i)),Mo={},jo=t=>{var r=Mo[t];return r===void 0?pe(t):r},Yr=()=>{if(typeof globalThis=="object")return globalThis;function t(r){r.$$$embind_global$$$=r;var n=typeof $$$embind_global$$$=="object"&&r.$$$embind_global$$$==r;return n||delete r.$$$embind_global$$$,n}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&t(global)?$$$embind_global$$$=global:typeof self=="object"&&t(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Fo=t=>t===0?Le.toHandle(Yr()):(t=jo(t),Le.toHandle(Yr()[t])),Uo=t=>{var r=hr.length;return hr.push(t),r},Lo=(t,r)=>{for(var n=new Array(t),i=0;i<t;++i)n[i]=dr(T[r+i*4>>2],"parameter "+i);return n},Wo=Reflect.construct,zo=(t,r,n)=>{var i=[],c=t.toWireType(i,n);return i.length&&(T[r>>2]=Le.toHandle(i)),c},Vo=(t,r,n)=>{var i=Lo(t,r),c=i.shift();t--;var f=new Array(t),m=(b,S,$,U)=>{for(var L=0,H=0;H<t;++H)f[H]=i[H].readValueFromPointer(U+L),L+=i[H].argPackAdvance;for(var ae=n===1?Wo(S,f):S.apply(b,f),H=0;H<t;++H){var ce,K;(ce=(K=i[H]).deleteObject)===null||ce===void 0||ce.call(K,f[H])}return zo(c,$,ae)},p=`methodCaller<(${i.map(b=>b.name).join(", ")}) => ${c.name}>`;return Uo(Ct(p,m))},No=t=>{t>4&&(Te.get(t).refcount+=1)},Bo=t=>{var r=Le.toValue(t);tr(r),ur(t)},Ho=(t,r)=>{t=dr(t,"_emval_take_value");var n=t.readValueFromPointer(r);return Le.toHandle(n)},Yo=()=>{X("")},qo=(t,r,n)=>Y.copyWithin(t,r,r+n),Xo=()=>2147483648,Go=t=>{var r=A.buffer,n=(t-r.byteLength+65535)/65536;try{return A.grow(n),x(),1}catch{}},Jo=t=>{var r=Y.length;t>>>=0;var n=Xo();if(t>n)return!1;for(var i=(b,S)=>b+(S-b%S)%S,c=1;c<=4;c*=2){var f=r*(1+.2/c);f=Math.min(f,t+100663296);var m=Math.min(n,i(Math.max(t,f),65536)),p=Go(m);if(p)return!0}return!1},mr={},Zo=()=>g||"./this.program",_t=()=>{if(!_t.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:Zo()};for(var n in mr)mr[n]===void 0?delete r[n]:r[n]=mr[n];var i=[];for(var n in r)i.push(`${n}=${r[n]}`);_t.strings=i}return _t.strings},Ko=(t,r)=>{for(var n=0;n<t.length;++n)P[r++>>0]=t.charCodeAt(n);P[r>>0]=0},Qo=(t,r)=>{var n=0;return _t().forEach((i,c)=>{var f=r+n;T[t+c*4>>2]=f,Ko(i,f),n+=i.length+1}),0},ei=(t,r)=>{var n=_t();T[t>>2]=n.length;var i=0;return n.forEach(c=>i+=c.length+1),T[r>>2]=i,0},ti=t=>t,zt=t=>t%4===0&&(t%100!==0||t%400===0),ri=(t,r)=>{for(var n=0,i=0;i<=r;n+=t[i++]);return n},qr=[31,29,31,30,31,30,31,31,30,31,30,31],Xr=[31,28,31,30,31,30,31,31,30,31,30,31],ni=(t,r)=>{for(var n=new Date(t.getTime());r>0;){var i=zt(n.getFullYear()),c=n.getMonth(),f=(i?qr:Xr)[c];if(r>f-n.getDate())r-=f-n.getDate()+1,n.setDate(1),c<11?n.setMonth(c+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1));else return n.setDate(n.getDate()+r),n}return n};function ai(t,r,n){var i=Nr(t)+1,c=new Array(i);return Vr(t,c,0,c.length),c}var oi=(t,r)=>{P.set(t,r)},ii=(t,r,n,i)=>{var c=T[i+40>>2],f={tm_sec:O[i>>2],tm_min:O[i+4>>2],tm_hour:O[i+8>>2],tm_mday:O[i+12>>2],tm_mon:O[i+16>>2],tm_year:O[i+20>>2],tm_wday:O[i+24>>2],tm_yday:O[i+28>>2],tm_isdst:O[i+32>>2],tm_gmtoff:O[i+36>>2],tm_zone:c?vr(c):""},m=vr(n),p={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var b in p)m=m.replace(new RegExp(b,"g"),p[b]);var S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$=["January","February","March","April","May","June","July","August","September","October","November","December"];function U(C,R,ue){for(var ve=typeof C=="number"?C.toString():C||"";ve.length<R;)ve=ue[0]+ve;return ve}function L(C,R){return U(C,R,"0")}function H(C,R){function ue(ot){return ot<0?-1:ot>0?1:0}var ve;return(ve=ue(C.getFullYear()-R.getFullYear()))===0&&(ve=ue(C.getMonth()-R.getMonth()))===0&&(ve=ue(C.getDate()-R.getDate())),ve}function ae(C){switch(C.getDay()){case 0:return new Date(C.getFullYear()-1,11,29);case 1:return C;case 2:return new Date(C.getFullYear(),0,3);case 3:return new Date(C.getFullYear(),0,2);case 4:return new Date(C.getFullYear(),0,1);case 5:return new Date(C.getFullYear()-1,11,31);case 6:return new Date(C.getFullYear()-1,11,30)}}function ce(C){var R=ni(new Date(C.tm_year+1900,0,1),C.tm_yday),ue=new Date(R.getFullYear(),0,4),ve=new Date(R.getFullYear()+1,0,4),ot=ae(ue),Nt=ae(ve);return H(ot,R)<=0?H(Nt,R)<=0?R.getFullYear()+1:R.getFullYear():R.getFullYear()-1}var K={"%a":C=>S[C.tm_wday].substring(0,3),"%A":C=>S[C.tm_wday],"%b":C=>$[C.tm_mon].substring(0,3),"%B":C=>$[C.tm_mon],"%C":C=>{var R=C.tm_year+1900;return L(R/100|0,2)},"%d":C=>L(C.tm_mday,2),"%e":C=>U(C.tm_mday,2," "),"%g":C=>ce(C).toString().substring(2),"%G":C=>ce(C),"%H":C=>L(C.tm_hour,2),"%I":C=>{var R=C.tm_hour;return R==0?R=12:R>12&&(R-=12),L(R,2)},"%j":C=>L(C.tm_mday+ri(zt(C.tm_year+1900)?qr:Xr,C.tm_mon-1),3),"%m":C=>L(C.tm_mon+1,2),"%M":C=>L(C.tm_min,2),"%n":()=>`
`,"%p":C=>C.tm_hour>=0&&C.tm_hour<12?"AM":"PM","%S":C=>L(C.tm_sec,2),"%t":()=>"	","%u":C=>C.tm_wday||7,"%U":C=>{var R=C.tm_yday+7-C.tm_wday;return L(Math.floor(R/7),2)},"%V":C=>{var R=Math.floor((C.tm_yday+7-(C.tm_wday+6)%7)/7);if((C.tm_wday+371-C.tm_yday-2)%7<=2&&R++,R){if(R==53){var ue=(C.tm_wday+371-C.tm_yday)%7;ue!=4&&(ue!=3||!zt(C.tm_year))&&(R=1)}}else{R=52;var ve=(C.tm_wday+7-C.tm_yday-1)%7;(ve==4||ve==5&&zt(C.tm_year%400-1))&&R++}return L(R,2)},"%w":C=>C.tm_wday,"%W":C=>{var R=C.tm_yday+7-(C.tm_wday+6)%7;return L(Math.floor(R/7),2)},"%y":C=>(C.tm_year+1900).toString().substring(2),"%Y":C=>C.tm_year+1900,"%z":C=>{var R=C.tm_gmtoff,ue=R>=0;return R=Math.abs(R)/60,R=R/60*100+R%60,(ue?"+":"-")+("0000"+R).slice(-4)},"%Z":C=>C.tm_zone,"%%":()=>"%"};m=m.replace(/%%/g,"\0\0");for(var b in K)m.includes(b)&&(m=m.replace(new RegExp(b,"g"),K[b](f)));m=m.replace(/\0\0/g,"%");var ge=ai(m);return ge.length>r?0:(oi(ge,t),ge.length-1)},si=(t,r,n,i,c)=>ii(t,r,n,i);Or=a.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Ra(),at=a.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},Ba(),Wa(),Ka(),Ur=a.UnboundTypeError=ro(Error,"UnboundTypeError"),so(),co();var li={s:Ca,u:_a,b:Ta,g:Pa,q:$a,J:Ea,f:Oa,V:ka,d:Sa,da:xa,Q:Ia,_:Aa,ca:no,ba:oo,w:io,Y:uo,x:vo,h:ho,L:po,M:go,t:bo,o:wo,K:So,C:xo,A:Io,ea:Ro,$:Do,R:Ao,ha:ur,fa:Fo,Z:Vo,N:No,O:Bo,aa:Ho,B:Yo,X:qo,W:Jo,T:Qo,U:ei,E:Ti,D:vi,F:Si,n:Pi,a:ci,e:mi,m:fi,k:gi,H:Ci,v:bi,G:_i,z:Ei,P:ki,l:pi,j:hi,c:di,p:ui,I:wi,r:$i,i:yi,y:Oi,ga:ti,S:si},de=wa(),We=a._free=t=>(We=a._free=de.ka)(t),pr=a._malloc=t=>(pr=a._malloc=de.la)(t),Gr=t=>(Gr=de.na)(t),ne=(t,r)=>(ne=de.oa)(t,r),St=t=>(St=de.pa)(t),se=()=>(se=de.qa)(),le=t=>(le=de.ra)(t),Jr=t=>(Jr=de.sa)(t),Zr=t=>(Zr=de.ta)(t),Kr=(t,r,n)=>(Kr=de.ua)(t,r,n),Qr=t=>(Qr=de.va)(t);a.dynCall_viijii=(t,r,n,i,c,f,m)=>(a.dynCall_viijii=de.wa)(t,r,n,i,c,f,m);var en=a.dynCall_jiiii=(t,r,n,i,c)=>(en=a.dynCall_jiiii=de.xa)(t,r,n,i,c);a.dynCall_iiiiij=(t,r,n,i,c,f,m)=>(a.dynCall_iiiiij=de.ya)(t,r,n,i,c,f,m),a.dynCall_iiiiijj=(t,r,n,i,c,f,m,p,b)=>(a.dynCall_iiiiijj=de.za)(t,r,n,i,c,f,m,p,b),a.dynCall_iiiiiijj=(t,r,n,i,c,f,m,p,b,S)=>(a.dynCall_iiiiiijj=de.Aa)(t,r,n,i,c,f,m,p,b,S);function ci(t,r){var n=se();try{return ie(t)(r)}catch(i){if(le(n),i!==i+0)throw i;ne(1,0)}}function ui(t,r,n,i){var c=se();try{ie(t)(r,n,i)}catch(f){if(le(c),f!==f+0)throw f;ne(1,0)}}function di(t,r,n){var i=se();try{ie(t)(r,n)}catch(c){if(le(i),c!==c+0)throw c;ne(1,0)}}function fi(t,r,n,i){var c=se();try{return ie(t)(r,n,i)}catch(f){if(le(c),f!==f+0)throw f;ne(1,0)}}function vi(t,r,n,i,c){var f=se();try{return ie(t)(r,n,i,c)}catch(m){if(le(f),m!==m+0)throw m;ne(1,0)}}function hi(t,r){var n=se();try{ie(t)(r)}catch(i){if(le(n),i!==i+0)throw i;ne(1,0)}}function mi(t,r,n){var i=se();try{return ie(t)(r,n)}catch(c){if(le(i),c!==c+0)throw c;ne(1,0)}}function pi(t){var r=se();try{ie(t)()}catch(n){if(le(r),n!==n+0)throw n;ne(1,0)}}function gi(t,r,n,i,c){var f=se();try{return ie(t)(r,n,i,c)}catch(m){if(le(f),m!==m+0)throw m;ne(1,0)}}function yi(t,r,n,i,c,f,m,p,b,S,$){var U=se();try{ie(t)(r,n,i,c,f,m,p,b,S,$)}catch(L){if(le(U),L!==L+0)throw L;ne(1,0)}}function bi(t,r,n,i,c,f,m){var p=se();try{return ie(t)(r,n,i,c,f,m)}catch(b){if(le(p),b!==b+0)throw b;ne(1,0)}}function wi(t,r,n,i,c){var f=se();try{ie(t)(r,n,i,c)}catch(m){if(le(f),m!==m+0)throw m;ne(1,0)}}function Ci(t,r,n,i,c,f){var m=se();try{return ie(t)(r,n,i,c,f)}catch(p){if(le(m),p!==p+0)throw p;ne(1,0)}}function _i(t,r,n,i,c,f,m,p){var b=se();try{return ie(t)(r,n,i,c,f,m,p)}catch(S){if(le(b),S!==S+0)throw S;ne(1,0)}}function Si(t,r,n,i){var c=se();try{return ie(t)(r,n,i)}catch(f){if(le(c),f!==f+0)throw f;ne(1,0)}}function Ti(t,r,n,i){var c=se();try{return ie(t)(r,n,i)}catch(f){if(le(c),f!==f+0)throw f;ne(1,0)}}function Pi(t){var r=se();try{return ie(t)()}catch(n){if(le(r),n!==n+0)throw n;ne(1,0)}}function $i(t,r,n,i,c,f,m,p){var b=se();try{ie(t)(r,n,i,c,f,m,p)}catch(S){if(le(b),S!==S+0)throw S;ne(1,0)}}function Ei(t,r,n,i,c,f,m,p,b,S,$,U){var L=se();try{return ie(t)(r,n,i,c,f,m,p,b,S,$,U)}catch(H){if(le(L),H!==H+0)throw H;ne(1,0)}}function Oi(t,r,n,i,c,f,m,p,b,S,$,U,L,H,ae,ce){var K=se();try{ie(t)(r,n,i,c,f,m,p,b,S,$,U,L,H,ae,ce)}catch(ge){if(le(K),ge!==ge+0)throw ge;ne(1,0)}}function ki(t,r,n,i,c){var f=se();try{return en(t,r,n,i,c)}catch(m){if(le(f),m!==m+0)throw m;ne(1,0)}}var Vt;ee=function t(){Vt||tn(),Vt||(ee=t)};function tn(){if(B>0||(V(),B>0))return;function t(){Vt||(Vt=!0,a.calledRun=!0,!q&&(be(),s(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),Ee()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),t()},1)):t()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return tn(),o.ready}})();function pl(e){return $r(Er,e)}async function gl(e,o){return hl(Er,e,o)}async function yl(e,o){return ml(Er,e,o)}var $t;class pn extends EventTarget{constructor(o={}){var a;super(),Bs(this,$t,void 0);try{const s=(a=o==null?void 0:o.formats)==null?void 0:a.filter(u=>u!=="unknown");if((s==null?void 0:s.length)===0)throw new TypeError("Hint option provided, but is empty.");s==null||s.forEach(u=>{if(!Gt.has(u))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${u}' is not a valid enum value of type BarcodeFormat.`)}),Hs(this,$t,s??[]),pl().then(u=>{this.dispatchEvent(new CustomEvent("load",{detail:u}))}).catch(u=>{this.dispatchEvent(new CustomEvent("error",{detail:u}))})}catch(s){throw fn(s,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return Ys.filter(o=>o!=="unknown")}async detect(o){try{const a=await Qs(o);if(a===null)return[];let s;try{ea(a)?s=await gl(a,{tryHarder:!0,formats:dn(this,$t).map(u=>Gt.get(u))}):s=await yl(a,{tryHarder:!0,formats:dn(this,$t).map(u=>Gt.get(u))})}catch(u){throw console.error(u),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return s.map(u=>{const{topLeft:{x:l,y:g},topRight:{x:_,y:h},bottomLeft:{x:y,y:v},bottomRight:{x:d,y:E}}=u.position,k=Math.min(l,_,y,d),A=Math.min(g,h,v,E),q=Math.max(l,_,y,d),P=Math.max(g,h,v,E);return{boundingBox:new DOMRectReadOnly(k,A,q-k,P-A),rawValue:u.text,format:qs(u.format),cornerPoints:[{x:l,y:g},{x:_,y:h},{x:d,y:E},{x:y,y:v}]}})}catch(a){throw fn(a,"Failed to execute 'detect' on 'BarcodeDetector'")}}}$t=new WeakMap;const aa=(e,o,a="error")=>{let s,u;const l=new Promise((g,_)=>{s=g,u=_,e.addEventListener(o,s),e.addEventListener(a,u)});return l.finally(()=>{e.removeEventListener(o,s),e.removeEventListener(a,u)}),l},gn=e=>new Promise(o=>setTimeout(o,e));class oa extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class bl extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class wl extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}let ia;async function Cl(e){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new pn({formats:e});const o=await window.BarcodeDetector.getSupportedFormats(),a=e.filter(s=>!o.includes(s));return a.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(a)}. Will use polyfill.`),new pn({formats:e})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:e}))}async function sa(e){ia=await Cl(e)}const _l=async(e,{detectHandler:o,locateHandler:a,minDelay:s,formats:u})=>{console.debug("[vue-qrcode-reader] start scanning"),await sa(u);const l=g=>async _=>{if(e.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:h,contentBefore:y,lastScanHadContent:v}=g;if(_-h<s)window.requestAnimationFrame(l(g));else{const d=await ia.detect(e),E=d.some(q=>!y.includes(q.rawValue));E&&o(d);const k=d.length>0;k&&a(d),!k&&v&&a(d);const A={lastScanned:_,lastScanHadContent:k,contentBefore:E?d.map(q=>q.rawValue):y};window.requestAnimationFrame(l(A))}}};l({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())};var la={},Se={};Object.defineProperty(Se,"__esModule",{value:!0});Se.compactObject=da;Se.deprecated=Il;var Sl=Se.detectBrowser=Rl;Se.disableLog=Ol;Se.disableWarnings=kl;Se.extractVersion=Jt;Se.filterStats=Dl;Se.log=xl;Se.walkStats=Zt;Se.wrapPeerConnectionEvent=El;function Tl(e,o,a){return o=Pl(o),o in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a,e}function Pl(e){var o=$l(e,"string");return Ge(o)==="symbol"?o:String(o)}function $l(e,o){if(Ge(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,o||"default");if(Ge(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(e)}function Ge(e){"@babel/helpers - typeof";return Ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Ge(e)}var ca=!0,ua=!0;function Jt(e,o,a){var s=e.match(o);return s&&s.length>=a&&parseInt(s[a],10)}function El(e,o,a){if(e.RTCPeerConnection){var s=e.RTCPeerConnection.prototype,u=s.addEventListener;s.addEventListener=function(g,_){if(g!==o)return u.apply(this,arguments);var h=function(y){var v=a(y);v&&(_.handleEvent?_.handleEvent(v):_(v))};return this._eventMap=this._eventMap||{},this._eventMap[o]||(this._eventMap[o]=new Map),this._eventMap[o].set(_,h),u.apply(this,[g,h])};var l=s.removeEventListener;s.removeEventListener=function(g,_){if(g!==o||!this._eventMap||!this._eventMap[o])return l.apply(this,arguments);if(!this._eventMap[o].has(_))return l.apply(this,arguments);var h=this._eventMap[o].get(_);return this._eventMap[o].delete(_),this._eventMap[o].size===0&&delete this._eventMap[o],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[g,h])},Object.defineProperty(s,"on"+o,{get:function(){return this["_on"+o]},set:function(g){this["_on"+o]&&(this.removeEventListener(o,this["_on"+o]),delete this["_on"+o]),g&&this.addEventListener(o,this["_on"+o]=g)},enumerable:!0,configurable:!0})}}function Ol(e){return typeof e!="boolean"?new Error("Argument type: "+Ge(e)+". Please use a boolean."):(ca=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function kl(e){return typeof e!="boolean"?new Error("Argument type: "+Ge(e)+". Please use a boolean."):(ua=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function xl(){if((typeof window>"u"?"undefined":Ge(window))==="object"){if(ca)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Il(e,o){ua&&console.warn(e+" is deprecated, please use "+o+" instead.")}function Rl(e){var o={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return o.browser="Not a browser.",o;var a=e.navigator;if(a.mozGetUserMedia)o.browser="firefox",o.version=Jt(a.userAgent,/Firefox\/(\d+)\./,1);else if(a.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)o.browser="chrome",o.version=Jt(a.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.RTCPeerConnection&&a.userAgent.match(/AppleWebKit\/(\d+)\./))o.browser="safari",o.version=Jt(a.userAgent,/AppleWebKit\/(\d+)\./,1),o.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return o.browser="Not a supported browser.",o;return o}function yn(e){return Object.prototype.toString.call(e)==="[object Object]"}function da(e){return yn(e)?Object.keys(e).reduce(function(o,a){var s=yn(e[a]),u=s?da(e[a]):e[a],l=s&&!Object.keys(u).length;return u===void 0||l?o:Object.assign(o,Tl({},a,u))},{}):e}function Zt(e,o,a){!o||a.has(o.id)||(a.set(o.id,o),Object.keys(o).forEach(function(s){s.endsWith("Id")?Zt(e,e.get(o[s]),a):s.endsWith("Ids")&&o[s].forEach(function(u){Zt(e,e.get(u),a)})}))}function Dl(e,o,a){var s=a?"outbound-rtp":"inbound-rtp",u=new Map;if(o===null)return u;var l=[];return e.forEach(function(g){g.type==="track"&&g.trackIdentifier===o.id&&l.push(g)}),l.forEach(function(g){e.forEach(function(_){_.type===s&&_.trackId===g.id&&Zt(e,_,u)})}),u}Object.defineProperty(la,"__esModule",{value:!0});var Al=la.shimGetUserMedia=Fl,Ml=jl(Se);function fa(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,a=new WeakMap;return(fa=function(s){return s?a:o})(e)}function jl(e,o){if(e&&e.__esModule)return e;if(e===null||qe(e)!=="object"&&typeof e!="function")return{default:e};var a=fa(o);if(a&&a.has(e))return a.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var g=u?Object.getOwnPropertyDescriptor(e,l):null;g&&(g.get||g.set)?Object.defineProperty(s,l,g):s[l]=e[l]}return s.default=e,a&&a.set(e,s),s}function qe(e){"@babel/helpers - typeof";return qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},qe(e)}var bn=Ml.log;function Fl(e,o){var a=e&&e.navigator;if(a.mediaDevices){var s=function(h){if(qe(h)!=="object"||h.mandatory||h.optional)return h;var y={};return Object.keys(h).forEach(function(v){if(!(v==="require"||v==="advanced"||v==="mediaSource")){var d=qe(h[v])==="object"?h[v]:{ideal:h[v]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);var E=function(A,q){return A?A+q.charAt(0).toUpperCase()+q.slice(1):q==="deviceId"?"sourceId":q};if(d.ideal!==void 0){y.optional=y.optional||[];var k={};typeof d.ideal=="number"?(k[E("min",v)]=d.ideal,y.optional.push(k),k={},k[E("max",v)]=d.ideal,y.optional.push(k)):(k[E("",v)]=d.ideal,y.optional.push(k))}d.exact!==void 0&&typeof d.exact!="number"?(y.mandatory=y.mandatory||{},y.mandatory[E("",v)]=d.exact):["min","max"].forEach(function(A){d[A]!==void 0&&(y.mandatory=y.mandatory||{},y.mandatory[E(A,v)]=d[A])})}}),h.advanced&&(y.optional=(y.optional||[]).concat(h.advanced)),y},u=function(h,y){if(o.version>=61)return y(h);if(h=JSON.parse(JSON.stringify(h)),h&&qe(h.audio)==="object"){var v=function(A,q,P){q in A&&!(P in A)&&(A[P]=A[q],delete A[q])};h=JSON.parse(JSON.stringify(h)),v(h.audio,"autoGainControl","googAutoGainControl"),v(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=s(h.audio)}if(h&&qe(h.video)==="object"){var d=h.video.facingMode;d=d&&(qe(d)==="object"?d:{ideal:d});var E=o.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&!(a.mediaDevices.getSupportedConstraints&&a.mediaDevices.getSupportedConstraints().facingMode&&!E)){delete h.video.facingMode;var k;if(d.exact==="environment"||d.ideal==="environment"?k=["back","rear"]:(d.exact==="user"||d.ideal==="user")&&(k=["front"]),k)return a.mediaDevices.enumerateDevices().then(function(A){A=A.filter(function(P){return P.kind==="videoinput"});var q=A.find(function(P){return k.some(function(Y){return P.label.toLowerCase().includes(Y)})});return!q&&A.length&&k.includes("back")&&(q=A[A.length-1]),q&&(h.video.deviceId=d.exact?{exact:q.deviceId}:{ideal:q.deviceId}),h.video=s(h.video),bn("chrome: "+JSON.stringify(h)),y(h)})}h.video=s(h.video)}return bn("chrome: "+JSON.stringify(h)),y(h)},l=function(h){return o.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},g=function(h,y,v){u(h,function(d){a.webkitGetUserMedia(d,y,function(E){v&&v(l(E))})})};if(a.getUserMedia=g.bind(a),a.mediaDevices.getUserMedia){var _=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(h){return u(h,function(y){return _(y).then(function(v){if(y.audio&&!v.getAudioTracks().length||y.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(function(d){d.stop()}),new DOMException("","NotFoundError");return v},function(v){return Promise.reject(l(v))})})}}}}var va={};Object.defineProperty(va,"__esModule",{value:!0});var Ul=va.shimGetUserMedia=zl,Ll=Wl(Se);function ha(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,a=new WeakMap;return(ha=function(s){return s?a:o})(e)}function Wl(e,o){if(e&&e.__esModule)return e;if(e===null||dt(e)!=="object"&&typeof e!="function")return{default:e};var a=ha(o);if(a&&a.has(e))return a.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var g=u?Object.getOwnPropertyDescriptor(e,l):null;g&&(g.get||g.set)?Object.defineProperty(s,l,g):s[l]=e[l]}return s.default=e,a&&a.set(e,s),s}function dt(e){"@babel/helpers - typeof";return dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},dt(e)}function zl(e,o){var a=e&&e.navigator,s=e&&e.MediaStreamTrack;if(a.getUserMedia=function(h,y,v){Ll.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),a.mediaDevices.getUserMedia(h).then(y,v)},!(o.version>55&&"autoGainControl"in a.mediaDevices.getSupportedConstraints())){var u=function(h,y,v){y in h&&!(v in h)&&(h[v]=h[y],delete h[y])},l=a.mediaDevices.getUserMedia.bind(a.mediaDevices);if(a.mediaDevices.getUserMedia=function(h){return dt(h)==="object"&&dt(h.audio)==="object"&&(h=JSON.parse(JSON.stringify(h)),u(h.audio,"autoGainControl","mozAutoGainControl"),u(h.audio,"noiseSuppression","mozNoiseSuppression")),l(h)},s&&s.prototype.getSettings){var g=s.prototype.getSettings;s.prototype.getSettings=function(){var h=g.apply(this,arguments);return u(h,"mozAutoGainControl","autoGainControl"),u(h,"mozNoiseSuppression","noiseSuppression"),h}}if(s&&s.prototype.applyConstraints){var _=s.prototype.applyConstraints;s.prototype.applyConstraints=function(h){return this.kind==="audio"&&dt(h)==="object"&&(h=JSON.parse(JSON.stringify(h)),u(h,"autoGainControl","mozAutoGainControl"),u(h,"noiseSuppression","mozNoiseSuppression")),_.apply(this,[h])}}}}var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.shimAudioContext=Zl;Fe.shimCallbacksAPI=Yl;Fe.shimConstraints=ga;Fe.shimCreateOfferLegacy=Jl;var Vl=Fe.shimGetUserMedia=ql;Fe.shimLocalStreamsAPI=Bl;Fe.shimRTCIceServerUrls=Xl;Fe.shimRemoteStreamsAPI=Hl;Fe.shimTrackEventTransceiver=Gl;var ma=Nl(Se);function pa(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,a=new WeakMap;return(pa=function(s){return s?a:o})(e)}function Nl(e,o){if(e&&e.__esModule)return e;if(e===null||Je(e)!=="object"&&typeof e!="function")return{default:e};var a=pa(o);if(a&&a.has(e))return a.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var g=u?Object.getOwnPropertyDescriptor(e,l):null;g&&(g.get||g.set)?Object.defineProperty(s,l,g):s[l]=e[l]}return s.default=e,a&&a.set(e,s),s}function Je(e){"@babel/helpers - typeof";return Je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Je(e)}function Bl(e){if(!(Je(e)!=="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var o=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(a){var s=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(a)||this._localStreams.push(a),a.getAudioTracks().forEach(function(u){return o.call(s,u,a)}),a.getVideoTracks().forEach(function(u){return o.call(s,u,a)})},e.RTCPeerConnection.prototype.addTrack=function(a){for(var s=this,u=arguments.length,l=new Array(u>1?u-1:0),g=1;g<u;g++)l[g-1]=arguments[g];return l&&l.forEach(function(_){s._localStreams?s._localStreams.includes(_)||s._localStreams.push(_):s._localStreams=[_]}),o.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(a){var s=this;this._localStreams||(this._localStreams=[]);var u=this._localStreams.indexOf(a);if(u!==-1){this._localStreams.splice(u,1);var l=a.getTracks();this.getSenders().forEach(function(g){l.includes(g.track)&&s.removeTrack(g)})}})}}function Hl(e){if(!(Je(e)!=="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var s=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=function(u){u.streams.forEach(function(l){if(s._remoteStreams||(s._remoteStreams=[]),!s._remoteStreams.includes(l)){s._remoteStreams.push(l);var g=new Event("addstream");g.stream=l,s.dispatchEvent(g)}})})}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(function(u){if(a._remoteStreams||(a._remoteStreams=[]),!(a._remoteStreams.indexOf(u)>=0)){a._remoteStreams.push(u);var l=new Event("addstream");l.stream=u,a.dispatchEvent(l)}})}),o.apply(a,arguments)}}}function Yl(e){if(!(Je(e)!=="object"||!e.RTCPeerConnection)){var o=e.RTCPeerConnection.prototype,a=o.createOffer,s=o.createAnswer,u=o.setLocalDescription,l=o.setRemoteDescription,g=o.addIceCandidate;o.createOffer=function(h,y){var v=arguments.length>=2?arguments[2]:arguments[0],d=a.apply(this,[v]);return y?(d.then(h,y),Promise.resolve()):d},o.createAnswer=function(h,y){var v=arguments.length>=2?arguments[2]:arguments[0],d=s.apply(this,[v]);return y?(d.then(h,y),Promise.resolve()):d};var _=function(h,y,v){var d=u.apply(this,[h]);return v?(d.then(y,v),Promise.resolve()):d};o.setLocalDescription=_,_=function(h,y,v){var d=l.apply(this,[h]);return v?(d.then(y,v),Promise.resolve()):d},o.setRemoteDescription=_,_=function(h,y,v){var d=g.apply(this,[h]);return v?(d.then(y,v),Promise.resolve()):d},o.addIceCandidate=_}}function ql(e){var o=e&&e.navigator;if(o.mediaDevices&&o.mediaDevices.getUserMedia){var a=o.mediaDevices,s=a.getUserMedia.bind(a);o.mediaDevices.getUserMedia=function(u){return s(ga(u))}}!o.getUserMedia&&o.mediaDevices&&o.mediaDevices.getUserMedia&&(o.getUserMedia=(function(u,l,g){o.mediaDevices.getUserMedia(u).then(l,g)}).bind(o))}function ga(e){return e&&e.video!==void 0?Object.assign({},e,{video:ma.compactObject(e.video)}):e}function Xl(e){if(e.RTCPeerConnection){var o=e.RTCPeerConnection;e.RTCPeerConnection=function(a,s){if(a&&a.iceServers){for(var u=[],l=0;l<a.iceServers.length;l++){var g=a.iceServers[l];g.urls===void 0&&g.url?(ma.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,u.push(g)):u.push(a.iceServers[l])}a.iceServers=u}return new o(a,s)},e.RTCPeerConnection.prototype=o.prototype,"generateCertificate"in o&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}})}}function Gl(e){Je(e)==="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Jl(e){var o=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(a){if(a){typeof a.offerToReceiveAudio<"u"&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var s=this.getTransceivers().find(function(l){return l.receiver.track.kind==="audio"});a.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):a.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof a.offerToReceiveVideo<"u"&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);var u=this.getTransceivers().find(function(l){return l.receiver.track.kind==="video"});a.offerToReceiveVideo===!1&&u?u.direction==="sendrecv"?u.setDirection?u.setDirection("sendonly"):u.direction="sendonly":u.direction==="recvonly"&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive"):a.offerToReceiveVideo===!0&&!u&&this.addTransceiver("video",{direction:"recvonly"})}return o.apply(this,arguments)}}function Zl(e){Je(e)!=="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const Kl=e=>{let o=!1,a;return(...s)=>(o||(a=e(s),o=!0),a)};function Ve(e,o){if(e===!1)throw new Error(o??"assertion failure")}function wn(e){throw new Error("this code should be unreachable")}const Ql=Kl(()=>{const e=Sl(window);switch(e.browser){case"chrome":Al(window,e);break;case"firefox":Ul(window,e);break;case"safari":Vl(window,e);break;default:throw new oa}});let ft=Promise.resolve({type:"stop",data:{}});async function Cn(e,o,a){var s,u,l;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(o)),window.isSecureContext!==!0)throw new bl;if(((s=navigator==null?void 0:navigator.mediaDevices)==null?void 0:s.getUserMedia)===void 0)throw new oa;Ql(),console.debug("[vue-qrcode-reader] calling getUserMedia");const g=await navigator.mediaDevices.getUserMedia({audio:!1,video:o});e.srcObject!==void 0?e.srcObject=g:e.mozSrcObject!==void 0?e.mozSrcObject=g:window.URL.createObjectURL?e.src=window.URL.createObjectURL(g):window.webkitURL?e.src=window.webkitURL.createObjectURL(g):e.src=g.id,e.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([aa(e,"loadeddata"),gn(6e3).then(()=>{throw new wl})]),console.debug("[vue-qrcode-reader] video element loaded"),await gn(500);const[_]=g.getVideoTracks(),h=(l=(u=_==null?void 0:_.getCapabilities)==null?void 0:u.call(_))!=null?l:{};let y=!1;return a&&h.torch&&(await _.applyConstraints({advanced:[{torch:!0}]}),y=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:e,stream:g,capabilities:h,constraints:o,isTorchOn:y}}}async function ec(e,{constraints:o,torch:a,restart:s=!1}){ft=ft.then(l=>{if(l.type==="start"){const{data:{videoEl:g,stream:_,constraints:h,isTorchOn:y}}=l;return!s&&e===g&&o===h&&a===y?l:ya(g,_,y).then(()=>Cn(e,o,a))}else if(l.type==="stop"||l.type==="failed")return Cn(e,o,a);wn()}).catch(l=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${l}"`),{type:"failed",error:l}));const u=await ft;if(u.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(u.type==="failed")throw u.error;if(u.type==="start")return u.data.capabilities;wn()}async function ya(e,o,a){console.debug("[vue-qrcode-reader] stopping camera"),e.src="",e.srcObject=null,e.load(),await aa(e,"error");for(const s of o.getTracks())a!=null||await s.applyConstraints({advanced:[{torch:!1}]}),o.removeTrack(s),s.stop();return{type:"stop",data:{}}}async function Yt(){if(ft=ft.then(e=>{if(e.type==="stop"||e.type==="failed")return e;const{data:{videoEl:o,stream:a,isTorchOn:s}}=e;return ya(o,a,s)}),(await ft).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const tc=xe({__name:"QrcodeStream",props:{constraints:{type:Object,default(){return{facingMode:"environment"}}},formats:{type:Array,default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function}},emits:["detect","camera-on","camera-off","error"],setup(e,{emit:o}){const a=e,s=o,u=te(a.constraints),l=te(a.formats);ye(()=>a.constraints,(w,O)=>{JSON.stringify(w)!==JSON.stringify(O)&&(u.value=w)},{deep:!0}),ye(()=>a.formats,(w,O)=>{JSON.stringify(w)!==JSON.stringify(O)&&(l.value=w)},{deep:!0});const g=te(),_=te(),h=te(),y=te(!1),v=te(!1);pt(()=>{v.value=!0}),zi(()=>{Yt()});const d=me(()=>({torch:a.torch,constraints:u.value,shouldStream:v.value&&!a.paused}));ye(d,async w=>{const O=h.value;Ve(O!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const T=g.value;Ve(T!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const re=T.getContext("2d");if(Ve(re!==null,"if cavnas is defined, canvas 2d context should also be non-null"),w.shouldStream){Yt(),y.value=!1;try{const fe=await ec(O,w);v.value?(y.value=!0,s("camera-on",fe)):await Yt()}catch(fe){s("error",fe)}}else T.width=O.videoWidth,T.height=O.videoHeight,re.drawImage(O,0,0,O.videoWidth,O.videoHeight),Yt(),y.value=!1,s("camera-off")},{deep:!0}),ye(l,async w=>{v.value&&await sa(w)});const E=me(()=>d.value.shouldStream&&y.value);ye(E,w=>{if(w){Ve(g.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),k(g.value),Ve(_.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),k(_.value);const O=()=>a.track===void 0?500:40;Ve(h.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),_l(h.value,{detectHandler:T=>s("detect",T),formats:l.value,locateHandler:A,minDelay:O()})}});const k=w=>{const O=w.getContext("2d");Ve(O!==null,"canvas 2d context should always be non-null"),O.clearRect(0,0,w.width,w.height)},A=w=>{const O=_.value;Ve(O!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const T=h.value;if(Ve(T!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),w.length===0||a.track===void 0)k(O);else{const re=T.offsetWidth,fe=T.offsetHeight,x=T.videoWidth,N=T.videoHeight,Z=Math.max(re/x,fe/N),G=x*Z,V=N*Z,be=G/x,Ee=V/N,Oe=(re-G)/2,D=(fe-V)/2,z=({x:I,y:X})=>({x:Math.floor(I*be),y:Math.floor(X*Ee)}),B=({x:I,y:X})=>({x:Math.floor(I+Oe),y:Math.floor(X+D)}),ee=w.map(I=>{const{boundingBox:X,cornerPoints:Q}=I,{x:Ce,y:oe}=B(z({x:X.x,y:X.y})),{x:Ie,y:Ke}=z({x:X.width,y:X.height});return{...I,cornerPoints:Q.map(xt=>B(z(xt))),boundingBox:DOMRectReadOnly.fromRect({x:Ce,y:oe,width:Ie,height:Ke})}});O.width=T.offsetWidth,O.height=T.offsetHeight;const we=O.getContext("2d");a.track(ee,we)}},q={width:"100%",height:"100%",position:"relative","z-index":"0"},P={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},Y={width:"100%",height:"100%","object-fit":"cover"},W=me(()=>E.value?Y:{...Y,visibility:"hidden",position:"absolute"});return(w,O)=>(Ae(),Ne("div",{style:q},[j("video",{ref_key:"videoRef",ref:h,style:Vi(W.value),autoplay:"",muted:"",playsinline:""},null,4),Pe(j("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:g,style:Y},null,512),[[_r,!E.value]]),j("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:_,style:P},null,512),j("div",{style:P},[Ni(w.$slots,"default")])]))}}),$e=e=>(Xi("data-v-89d85af7"),e=e(),Gi(),e),rc={class:"task-info"},nc={class:"user-info"},ac=$e(()=>j("div",{class:"title"},"",-1)),oc={class:"content"},ic=$e(()=>j("div",{class:"line"},null,-1)),sc={class:"action-info"},lc={class:"title"},cc={class:"content"},uc={class:"item"},dc=$e(()=>j("div",{class:"left"},"",-1)),fc={class:"right"},vc={key:0,class:"item"},hc=$e(()=>j("div",{class:"left"},"",-1)),mc={class:"right"},pc={key:1,class:"item"},gc=$e(()=>j("div",{class:"left"},"",-1)),yc={class:"right"},bc={key:2,class:"item"},wc=$e(()=>j("div",{class:"left"},"",-1)),Cc={class:"right"},_c={key:3,class:"item"},Sc=$e(()=>j("div",{class:"left"},"",-1)),Tc={class:"right"},Pc={key:4,class:"item"},$c=$e(()=>j("div",{class:"left"},"",-1)),Ec={class:"right"},Oc={key:5,class:"item"},kc=$e(()=>j("div",{class:"left"},"",-1)),xc={class:"right"},Ic={key:6,class:"item"},Rc=$e(()=>j("div",{class:"left"},"",-1)),Dc={class:"right"},Ac={class:"item"},Mc=$e(()=>j("div",{class:"left"},"",-1)),jc={class:"right"},Fc={class:"item"},Uc=$e(()=>j("div",{class:"left"},"",-1)),Lc={class:"right"},Wc={class:"submit"},zc=xe({__name:"index",setup(e){const{initDictionarys:o,dictionaryTypes:a,findDictionary:s,findOtherLabel:u}=es(),l=Yi(),g=qi(),_=[".png",".jpg",".jpeg"],h=te(!1),y=te([]);let v=te({}),d=te({actionRes:1,fileIdList:[]});const E=()=>{if(!d.value.sbNo)return tt("");un({sbNo:d.value.sbNo}).then(W=>{if(!W.data)return tt("");d.value._sbId=W.data.id,d.value.sbcj=s(a.,W.data.sbcj),d.value.sbType=s(a.,W.data.sbType),d.value.sbClass=s(a.,W.data.sbClass),d.value.sbkjId=u(y,W.data.sbkjId),d.value.sbbh=W.data.sbbh})},k=W=>{un({sbNo:W}).then(w=>{if(!w.data)return tt("");d.value.sbNo=w.data.sbNo,d.value._sbId=w.data.id,d.value.sbcj=s(a.,w.data.sbcj),d.value.sbType=s(a.,w.data.sbType),d.value.sbClass=s(a.,w.data.sbClass),d.value.sbkjId=u(y,w.data.sbkjId),d.value.sbbh=w.data.sbbh}).finally(()=>{h.value=!1})},A=()=>{var w;if(d.value.actionRes===1&&!d.value._sbId)return tt(" ");let W={fileIdList:d.value.fileIdList&&((w=d.value.fileIdList)==null?void 0:w.map(O=>O.fileId)),remark:d.value.remark,sbId:d.value._sbId||null,taskId:l.params.id};d.value.actionRes?Vs(W).then(()=>{tt(""),setTimeout(()=>{g.back()},1e3)}):Ns(W).then(()=>{tt(""),setTimeout(()=>{g.back()},1e3)})},q=()=>{zs().then(W=>{y.value=W.data.map(w=>({label:w.kjName,value:w.id}))})},P=()=>{var W;Ls({yhbh:(W=yr.currentTaskUserInfo)==null?void 0:W.yhbh}).then(w=>{v.value.sbNo=w.data.sbNo,v.value.sbbh=w.data.sbbh})},Y=W=>{let w=new FormData;w.append("file",W);let O=W.name.split(".");return _.includes(`.${O[1]}`)?(Ws(w).then(T=>{T.data[0].isImage=!0,d.value.fileIdList.push(T.data[0])}),!1):tt(`${_.join("")}`)};return Bi(()=>{l.params.type==="5"&&(d.value.sbNo=v.value.sbNo,d.value._sbId=v.value.sbId,d.value.sbcj=s(a.,v.value.sbcj),d.value.sbType=s(a.,v.value.sbType),d.value.sbClass=s(a.,v.value.sbClass),d.value.sbkjId=u(y,v.value.sbkjId),d.value.sbbh=v.value.sbbh)}),pt(()=>{v.value=yr.currentTaskUserInfo,yr.currentTaskUserInfo.workType===3&&P(),l.params.type==="4"&&(d.value._sbId=v.value.sbId),q(),o([a.,a.,a.])}),(W,w)=>{var O,T,re,fe,x,N,Z,G;return Ae(),Ne("div",rc,[h.value?(Ae(),Hi(M(tc),{key:0,onDetect:k})):He("",!0),j("div",nc,[ac,j("div",oc,[j("div",null,""+ze((O=M(v))==null?void 0:O.yhbh),1),j("div",null,""+ze((T=M(v))==null?void 0:T.yhxm),1),j("div",null,""+ze((re=M(v))==null?void 0:re.yhMobile),1),j("div",null,""+ze((fe=M(v))==null?void 0:fe.address),1),j("div",null,""+ze(((x=M(v))==null?void 0:x.installAddr)||"-"),1),j("div",null,""+ze((N=M(v))==null?void 0:N.yysName),1),j("div",null,""+ze(((Z=M(v))==null?void 0:Z.sbNo)||"-"),1),j("div",null,""+ze(((G=M(v))==null?void 0:G.sbbh)||"-"),1)])]),ic,j("div",sc,[j("div",lc,""+ze(M(l).params.type==="5"?" (  )":""),1),j("div",cc,[j("div",uc,[dc,j("div",fc,[F(M(vs),{modelValue:M(d).actionRes,"onUpdate:modelValue":w[0]||(w[0]=V=>M(d).actionRes=V),direction:"horizontal"},{default:it(()=>[F(M(on),{name:1},{default:it(()=>[Tt("")]),_:1}),F(M(on),{name:0},{default:it(()=>[Tt("")]),_:1})]),_:1},8,["modelValue"])])]),M(d).actionRes===1&&!["4","5"].includes(M(l).params.type)?(Ae(),Ne("div",vc,[hc,j("div",mc,[Pe(j("input",{"onUpdate:modelValue":w[1]||(w[1]=V=>M(d).sbNo=V),style:{width:"48%"}},null,512),[[Ye,M(d).sbNo]]),F(M(br),{style:{"margin-left":"4px"},type:"primary",size:"small",onClick:E},{default:it(()=>[Tt("")]),_:1}),F(M(br),{style:{"margin-left":"4px"},type:"primary",size:"small",onClick:w[2]||(w[2]=V=>h.value=!0)},{default:it(()=>[Tt("")]),_:1})])])):He("",!0),M(d).actionRes===1&&M(l).params.type==="5"?(Ae(),Ne("div",pc,[gc,j("div",yc,[Pe(j("input",{"onUpdate:modelValue":w[3]||(w[3]=V=>M(d).sbNo=V),disabled:!0},null,512),[[Ye,M(d).sbNo]])])])):He("",!0),M(d).actionRes===1&&M(l).params.type!=="4"?(Ae(),Ne("div",bc,[wc,j("div",Cc,[Pe(j("input",{"onUpdate:modelValue":w[4]||(w[4]=V=>M(d).sbbh=V),disabled:!0},null,512),[[Ye,M(d).sbbh]])])])):He("",!0),M(d).actionRes===1&&M(l).params.type!=="4"?(Ae(),Ne("div",_c,[Sc,j("div",Tc,[Pe(j("input",{"onUpdate:modelValue":w[5]||(w[5]=V=>M(d).sbcj=V),disabled:!0},null,512),[[Ye,M(d).sbcj]])])])):He("",!0),M(d).actionRes===1&&M(l).params.type!=="4"?(Ae(),Ne("div",Pc,[$c,j("div",Ec,[Pe(j("input",{"onUpdate:modelValue":w[6]||(w[6]=V=>M(d).sbType=V),disabled:!0},null,512),[[Ye,M(d).sbType]])])])):He("",!0),M(d).actionRes===1&&M(l).params.type!=="4"?(Ae(),Ne("div",Oc,[kc,j("div",xc,[Pe(j("input",{"onUpdate:modelValue":w[7]||(w[7]=V=>M(d).sbkjId=V),disabled:!0},null,512),[[Ye,M(d).sbkjId]])])])):He("",!0),M(d).actionRes===1&&M(l).params.type!=="4"?(Ae(),Ne("div",Ic,[Rc,j("div",Dc,[Pe(j("input",{"onUpdate:modelValue":w[8]||(w[8]=V=>M(d).sbClass=V),disabled:!0},null,512),[[Ye,M(d).sbClass]])])])):He("",!0),j("div",Ac,[Mc,j("div",jc,[Pe(j("textarea",{"onUpdate:modelValue":w[9]||(w[9]=V=>M(d).remark=V)},null,512),[[Ye,M(d).remark]])])]),j("div",Fc,[Uc,j("div",Lc,[F(M(Us),{modelValue:M(d).fileIdList,"onUpdate:modelValue":w[10]||(w[10]=V=>M(d).fileIdList=V),"before-read":Y,multiple:"","max-count":2},null,8,["modelValue"])])])]),j("div",Wc,[F(M(br),{class:"btn",type:"primary",size:"small",onClick:A},{default:it(()=>[Tt("  ")]),_:1})])])])}}}),Hc=Ji(zc,[["__scopeId","data-v-89d85af7"]]);export{Hc as default};
